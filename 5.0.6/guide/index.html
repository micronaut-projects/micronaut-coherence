<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>Micronaut Coherence</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/custom.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <link rel="stylesheet" href="../css/highlight/agate.css">
    <script src="../js/highlight.pack.js"></script>
    <script src="../js/guide.js"></script>
    <script src="../js/multi-language-sample.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="stylesheet" href="../css/multi-language-sample.css"/>
    <script src="../js/docs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.13/clipboard.min.js"></script>
    <script type="text/javascript">
        function addJsClass(el) {
            var classes = document.body.className.split(" ");
            classes.push("js");
            document.body.className = classes.join(" ");
        }
    </script>

</head>

<body class="body" id="docs" onload="addJsClass();" onhashchange="highlightMenu()">

<div id="table-of-content-nav-link" class="desktop">
    <a id="theme-switcher" title="Switch to dark theme" href="javascript:switchTheme(true)"><i class="fa fa-moon-o"></i></a>
    <a title="Collapse/Open Table of contents" title="Hide Table of Contents" href="javascript:hideTableOfContents();" class="button">[ + ]</a>
</div>

<div id="main">
    <div id="navigation" class="no-print">
        <div class="navTitle">
            <span id="logo"><a href="http://micronaut.io" title="Go to Micronaut Website"><img src="../img/micronaut-logo-white.svg" alt="Micronaut"/></a></span>
        </div>
        <div class="navLinks">
            <ul>
                    <li><div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)" class="desktop">
                            <a href="../guide/index.html" class="button">Table of contents</a>
                            <div id="nav-summary-childs" style="display:none;">
                                
                                <div class="toc-item" style="margin-left:0"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#releaseHistory"><strong>2</strong><span>Release History</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#quickStart"><strong>3</strong><span>Coherence Quick Start</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#bootstrap"><strong>4</strong><span>Bootstrapping Coherence</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#repository"><strong>5</strong><span>Micronaut Data with Coherence</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#injection"><strong>6</strong><span>Inject Coherence Resources into Beans</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#events"><strong>7</strong><span>Events</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#messagingWithTopics"><strong>8</strong><span>Messaging with Coherence Topics</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#filterBinding"><strong>9</strong><span>Filter Binding Annotations</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#valueExtractorBinding"><strong>10</strong><span>Extractor Binding Annotations</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#transientInjection"><strong>11</strong><span>Injection into Deserialized Objects</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#coherenceXmlInjection"><strong>12</strong><span>Injecting Beans into Coherence Configuration</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#coherenceHttpSessions"><strong>13</strong><span>Using Coherence to store HTTP sessions</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#cache"><strong>14</strong><span>Using Coherence as Micronaut Cache implementation</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#distributedConfiguration"><strong>15</strong><span>Using Coherence as a Distributed Configuration provider</span></a></div>
                                
                            </div>
                        </div>
                    </li>

                <li id="table-of-content-nav-link-mobile" class="mobile">
                    <a title="Scroll to Table of contents" href="javascript:scrollToTop();" class="button">Toc</a>
                </li>
                <li class="desktop">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to API documentation" href="../api/index.html" class="button">API</a>
                </li>
                <li class="desktop">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Configuration Reference</a>
                </li>
                <li class="mobile">
                    <a title="Go to Configuration Reference documentation" href="../guide/configurationreference.html" class="button">Conf</a>
                </li>
            </ul>

        </div>
    </div>
    
    <div id="table-of-content">
        <div class="toc-content">

        <h2>Table of Contents</h2>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-introduction"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-releaseHistory"><a href="#releaseHistory"><strong>2</strong><span>Release History</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-quickStart"><a href="#quickStart"><strong>3</strong><span>Coherence Quick Start</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-bootstrap"><a href="#bootstrap"><strong>4</strong><span>Bootstrapping Coherence</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-defaultSession"><a href="#defaultSession"><strong>4.1</strong><span>Using the Default Session</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-multiple"><a href="#multiple"><strong>4.2</strong><span>Configure Multiple Sessions</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-configuration"><a href="#configuration"><strong>4.3</strong><span>Session Configuration Properties</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-repository"><a href="#repository"><strong>5</strong><span>Micronaut Data with Coherence</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-limitations"><a href="#limitations"><strong>5.1</strong><span>Limitations</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-started"><a href="#started"><strong>5.2</strong><span>Build</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-using"><a href="#using"><strong>5.3</strong><span>Using Micronaut Data</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-injection"><a href="#injection"><strong>6</strong><span>Inject Coherence Resources into Beans</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-injectNamedMap"><a href="#injectNamedMap"><strong>6.1</strong><span>Injecting NamedMap &amp; NamedCache</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-injectAsyncNamedMap"><a href="#injectAsyncNamedMap"><strong>6.1.1</strong><span>Injecting AsyncNamedMap &amp; AsyncNamedCache</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-injectViews"><a href="#injectViews"><strong>6.1.2</strong><span>Injecting Views (CQC)</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-injectNamedTopic"><a href="#injectNamedTopic"><strong>6.2</strong><span>Injecting NamedTopic</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-injectTopicPublisher"><a href="#injectTopicPublisher"><strong>6.2.1</strong><span>Injecting a NamedTopic Publisher</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-injectTopicSubscriber"><a href="#injectTopicSubscriber"><strong>6.2.2</strong><span>Injecting a NamedTopic Subscriber</span></a></div>
        
        <div class="toc-item" style="margin-left:30px" id="toc-item-injectTopicSubscriberFiltered"><a href="#injectTopicSubscriberFiltered"><strong>6.2.2.1</strong><span>Filtering Topic Messages</span></a></div>
        
        <div class="toc-item" style="margin-left:30px" id="toc-item-injectTopicSubscriberTransformed"><a href="#injectTopicSubscriberTransformed"><strong>6.2.2.2</strong><span>Transforming Topic Messages</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-injectSession"><a href="#injectSession"><strong>6.3</strong><span>Injecting a Session</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-events"><a href="#events"><strong>7</strong><span>Events</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-mapEvents"><a href="#mapEvents"><strong>7.1</strong><span>MapEvent Listeners</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-eventTypes"><a href="#eventTypes"><strong>7.1.1</strong><span>Receive Specific Event Types</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-filteringEvents"><a href="#filteringEvents"><strong>7.1.2</strong><span>Filtering Events</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-transformingEvents"><a href="#transformingEvents"><strong>7.1.3</strong><span>Transforming Events</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-coherenceEvents"><a href="#coherenceEvents"><strong>7.2</strong><span>Coherence Event Interceptors</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-coherenceLifecycleEvent"><a href="#coherenceLifecycleEvent"><strong>7.2.1</strong><span>Coherence Lifecycle Events</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-sessionLifecycleEvent"><a href="#sessionLifecycleEvent"><strong>7.2.2</strong><span>Session Lifecycle Events</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-lifecycleEvent"><a href="#lifecycleEvent"><strong>7.2.3</strong><span>ConfigurableCacheFactory Lifecycle Events</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-cacheLifecycleEvent"><a href="#cacheLifecycleEvent"><strong>7.2.4</strong><span>Cache Lifecycle Events</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-entryEvent"><a href="#entryEvent"><strong>7.2.5</strong><span>Entry Events</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-entryProcessorEvent"><a href="#entryProcessorEvent"><strong>7.2.6</strong><span>EntryProcessor Events</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-transactionEvent"><a href="#transactionEvent"><strong>7.2.7</strong><span>Partition Level Transaction Events</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-transferEvent"><a href="#transferEvent"><strong>7.2.8</strong><span>Partition Transfer Events</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-unsolicitedCommitEvent"><a href="#unsolicitedCommitEvent"><strong>7.2.9</strong><span>Unsolicited Commit Events</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-messagingWithTopics"><a href="#messagingWithTopics"><strong>8</strong><span>Messaging with Coherence Topics</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-publishers"><a href="#publishers"><strong>8.1</strong><span>Define Publishers - @CoherencePublisher</span></a></div>
        
        <div class="toc-item" style="margin-left:10px" id="toc-item-subscribers"><a href="#subscribers"><strong>8.2</strong><span>Define Subscribers - @CoherenceTopicListener</span></a></div>
        
        <div class="toc-item" style="margin-left:20px" id="toc-item-forwarding"><a href="#forwarding"><strong>8.2.1</strong><span>Forwarding Messages with @SendTo</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-filterBinding"><a href="#filterBinding"><strong>9</strong><span>Filter Binding Annotations</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-valueExtractorBinding"><a href="#valueExtractorBinding"><strong>10</strong><span>Extractor Binding Annotations</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-transientInjection"><a href="#transientInjection"><strong>11</strong><span>Injection into Deserialized Objects</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-coherenceXmlInjection"><a href="#coherenceXmlInjection"><strong>12</strong><span>Injecting Beans into Coherence Configuration</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-coherenceHttpSessions"><a href="#coherenceHttpSessions"><strong>13</strong><span>Using Coherence to store HTTP sessions</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-cache"><a href="#cache"><strong>14</strong><span>Using Coherence as Micronaut Cache implementation</span></a></div>
        
        <div class="toc-item" style="margin-left:0px" id="toc-item-distributedConfiguration"><a href="#distributedConfiguration"><strong>15</strong><span>Using Coherence as a Distributed Configuration provider</span></a></div>
        
        </div>
    </div>
    
    <div class="docs-content">
    <div class="project">
        <h1>Micronaut Coherence</h1>
        <p></p>
        <p>Integration between Micronaut and Oracle Coherence</p>
        <p><strong>Version:</strong> 5.0.6 </p>
    </div>
    
<h1 id="introduction"><a class="anchor" href="#introduction"></a>1 Introduction</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/introduction.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="https://coherence.community/">Oracle Coherence</a> is a scalable, fault-tolerant, cloud-ready, distributed platform for building grid-based applications and reliably storing data. The product is used at scale, for both compute and raw storage, in a vast array of industries such as critical financial trading systems, high performance telecommunication products and e-commerce applications.</p>
</div>
<div class="paragraph">
<p>Micronaut features dedicated support to bootstrap Coherence and for both injection of Coherence resources into beans and injection of beans into Coherence resources. Micronaut Injection simplifies application code as Coherence <em>maps</em>, <em>caches</em> and <em>topics</em> are just injected instead of being obtained via Coherence APIs.</p>
</div>
<div class="paragraph">
<p>Using annotated event listener methods simplifies building reactive code that responds to Coherence cache events.</p>
</div>

<h1 id="releaseHistory"><a class="anchor" href="#releaseHistory"></a>2 Release History</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/releaseHistory.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>For this project, you can find a list of releases (with release notes) here:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/micronaut-projects/micronaut-coherence/releases">https://github.com/micronaut-projects/micronaut-coherence/releases</a></p>
</div>
<div class="paragraph">
<p>Important Changes in Release 5.0.0</p>
</div>
<div class="paragraph">
<p>The following outlines backwards-incompatible changes made in this release:</p>
</div>
<div class="paragraph">
<p><code>gRPC</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Removed the configuration of gRPC proxies within application configuration resources (such as application.yaml).
Both gRPC clients and proxies are now configured in a similar fashion to extend client and proxies.  Please see
the Coherence <a href="https://github.com/oracle/coherence/blob/main/prj/coherence-grpc/README.adoc">gRPC</a> docs for more details.</p>
</li>
<li>
<p>Removed the <code>coherence-grpc-client</code> module.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Coherence Configuration Client</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reworked how the client connects by using sessions instead of hard coding an address and port and forcing the
client to use gRPC.  By using a session, the client can be a storage-disabled cluster member, an extend client, or
a gRPC client.  See the Coherence Distributed Configuration <a href="#distributedConfiguration">documentation</a> for details.</p>
</li>
</ul>
</div>

<h1 id="quickStart"><a class="anchor" href="#quickStart"></a>3 Coherence Quick Start</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/quickStart.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To add support for Oracle Coherence to an existing project, you should first add the Micronaut Coherence configuration to your build configuration. For example:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut.coherence:micronaut-coherence")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.coherence&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-coherence&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>Next, you also need to add the version of Coherence that your application will be using. For example, to use Coherence CE:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"com.oracle.coherence.ce:coherence:24.03")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;com.oracle.coherence.ce&lt;/groupId&gt;
    &lt;artifactId&gt;coherence&lt;/artifactId&gt;
    &lt;version&gt;24.03&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Coherence CE 24.03 and newer require JDK 17 as a minimum!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There is no minimal configuration required to bootstrap Coherence.
If no specific configuration is provided Coherence will run with default values.
Some Coherence functionality can be configured using System properties. Add these properties to the application configuration file, for example:</p>
</div>
<div class="openblock">
<div class="title">Configure Coherence</div>
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">coherence.cluster=test-cluster
coherence.role=storage</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">coherence:
  cluster: test-cluster
  role: storage</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[coherence]
  cluster="test-cluster"
  role="storage"</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">coherence {
  cluster = "test-cluster"
  role = "storage"
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  coherence {
    cluster = "test-cluster"
    role = "storage"
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "coherence": {
    "cluster": "test-cluster",
    "role": "storage"
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The above configuration sets the cluster name to <code>test-cluster</code>, and the role name to <code>storage</code>.
Any Coherence system property (prefixed with <code>coherence.</code>) specified in the Micronaut configuration
will then be picked up by Coherence at runtime.</p>
</div>

<h1 id="bootstrap"><a class="anchor" href="#bootstrap"></a>4 Bootstrapping Coherence</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/bootstrap.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The default behavior of the Coherence Micronaut framework is to use the Coherence bootstrap API introduced in Coherence CE <code>20.12</code> to configure and create Coherence instances.
This means that Coherence resources in a Micronaut application are typically owned by a Coherence <code>Session</code>.</p>
</div>
<div class="paragraph">
<p>By default, Coherence will start a single Session configured to use the default Coherence configuration file.
This behaviour can easily be configured, either traditionally using Coherence system properties or using explicit Micronaut
configuration.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
When using Micronaut, all Coherence resources used by application code should be injected.
Applications should avoid calling Coherence APIs that create or initialise Coherence resources directly,
especially static CacheFactory methods. If application code calls these Coherence APIs it may cause Coherence to
be initialised too early in the start-up process before the Micronaut framework has initialised the Coherence
extensions. A typical symptom of this would be that Coherence starts without picking up the correct configuration
from the Micronaut framework.
</td>
</tr>
</table>
</div>

<h2 id="defaultSession"><a class="anchor" href="#defaultSession"></a>4.1 Using the Default Session</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/bootstrap/defaultSession.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The simplest configuration, applicable to the majority of applications that only require a single <code>Session</code>, is
to just configure and use the default <code>Session</code>. If the application is a Coherence cluster member, or a Coherence*Extend client,
then all that needs to be specified is the Coherence configuration file name (although even this is optional as
Coherence will use a default file name if none is configured).
Alternatively, if the application is a Coherence gRPC client, the default Session can be configured as a gRPC Session
(see the Coherence <a href="https://github.com/oracle/coherence/blob/main/prj/coherence-grpc/README.adoc">gRPC</a>).</p>
</div>
<div class="paragraph">
<p>As already mentioned in the <a href="#quickStart">Quick Start</a> section, the name of the Coherence configuration file for the default session can be set in the Micronaut config, for example in the application configuration file:</p>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">coherence.sessions.default.config=coherence-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">coherence:
  sessions:
    default:
      config: coherence-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[coherence]
  [coherence.sessions]
    [coherence.sessions.default]
      config="coherence-config.xml"</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">coherence {
  sessions {
    'default' {
      config = "coherence-config.xml"
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  coherence {
    sessions {
      default {
        config = "coherence-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "coherence": {
    "sessions": {
      "default": {
        "config": "coherence-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>

<h2 id="multiple"><a class="anchor" href="#multiple"></a>4.2 Configure Multiple Sessions</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/bootstrap/multiple.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>In the above configuration, the <code>coherence</code> section contains a <code>sessions</code> section which is the configuration of one
or more sessions. The format is a map using the session name as the map key. In the above example there is a single session with the name <code>default</code>.</p>
</div>
<div class="paragraph">
<p>In the example below, there are two sessions configured, one named <code>catalog</code> and one named <code>customer</code>:</p>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">coherence.sessions.catalog.config=catalog-config.xml
coherence.sessions.customer.config=customer-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">coherence:
  sessions:
    catalog:
      config: catalog-config.xml
    customer:
      config: customer-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[coherence]
  [coherence.sessions]
    [coherence.sessions.catalog]
      config="catalog-config.xml"
    [coherence.sessions.customer]
      config="customer-config.xml"</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">coherence {
  sessions {
    catalog {
      config = "catalog-config.xml"
    }
    customer {
      config = "customer-config.xml"
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  coherence {
    sessions {
      catalog {
        config = "catalog-config.xml"
      }
      customer {
        config = "customer-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "coherence": {
    "sessions": {
      "catalog": {
        "config": "catalog-config.xml"
      },
      "customer": {
        "config": "customer-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>default</code> session will only exist when zero sessions are specifically configured, or the <code>default</code> session is specifically configured.
For example, in the configuration below there wil be no <code>default</code> session, only a single session named <code>catalog</code>.
</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">coherence.sessions.catalog.config=catalog-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">coherence:
  sessions:
    catalog:
      config: catalog-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[coherence]
  [coherence.sessions]
    [coherence.sessions.catalog]
      config="catalog-config.xml"</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">coherence {
  sessions {
    catalog {
      config = "catalog-config.xml"
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  coherence {
    sessions {
      catalog {
        config = "catalog-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "coherence": {
    "sessions": {
      "catalog": {
        "config": "catalog-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, there will be two sessions, one named <code>catalog</code> and the <code>default</code> session.</p>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">coherence.sessions.catalog.config=catalog-config.xml
coherence.sessions.default.config=coherence-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">coherence:
  sessions:
    catalog:
      config: catalog-config.xml
    default:
      config: coherence-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[coherence]
  [coherence.sessions]
    [coherence.sessions.catalog]
      config="catalog-config.xml"
    [coherence.sessions.default]
      config="coherence-config.xml"</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">coherence {
  sessions {
    catalog {
      config = "catalog-config.xml"
    }
    'default' {
      config = "coherence-config.xml"
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  coherence {
    sessions {
      catalog {
        config = "catalog-config.xml"
      }
      default {
        config = "coherence-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "coherence": {
    "sessions": {
      "catalog": {
        "config": "catalog-config.xml"
      },
      "default": {
        "config": "coherence-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>

<h2 id="configuration"><a class="anchor" href="#configuration"></a>4.3 Session Configuration Properties</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/bootstrap/configuration.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>There are a number of fields that may be used to configure a <code>Session</code>, all of them are optional.</p>
</div>
<div class="sect2">
<h3 id="_configuration_file_name">Configuration File Name</h3>
<div class="paragraph">
<p>As already mentioned, the most common configuration to set will be the Coherence configuration file name.
This is set using the <code>config</code> property.
If not specified, the default value will be <code>coherence-cache-config.xml</code>.</p>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">coherence.sessions.default.config=coherence-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">coherence:
  sessions:
    default:
      config: coherence-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[coherence]
  [coherence.sessions]
    [coherence.sessions.default]
      config="coherence-config.xml"</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">coherence {
  sessions {
    'default' {
      config = "coherence-config.xml"
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  coherence {
    sessions {
      default {
        config = "coherence-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "coherence": {
    "sessions": {
      "default": {
        "config": "coherence-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scope_name">Scope Name</h3>
<div class="paragraph">
<p>A scope name is typically used in an application where the Coherence cluster member has multiple sessions.
The scope name is used to keep the sessions separate. The scope name will be applied to the session&#8217;s underlying
<code>ConfigurableCacheFactory</code> and used to scope Coherence services. In this way multiple session configurations may use identical service names, which will be kept separate using the scope.
On a Coherence cluster member each session should have a unique scope name.</p>
</div>
<div class="paragraph">
<p>In a client application, for example, a gRPC client, the scope name is used to map a client session to a corresponding scoped server session.</p>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">coherence.sessions.catalog.scope=Catalog
coherence.sessions.catalog.config=catalog-config.xml
coherence.sessions.customer.scope=Customer
coherence.sessions.customer.config=customer-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">coherence:
  sessions:
    catalog:
      scope: Catalog
      config: catalog-config.xml
    customer:
      scope: Customer
      config: customer-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[coherence]
  [coherence.sessions]
    [coherence.sessions.catalog]
      scope="Catalog"
      config="catalog-config.xml"
    [coherence.sessions.customer]
      scope="Customer"
      config="customer-config.xml"</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">coherence {
  sessions {
    catalog {
      scope = "Catalog"
      config = "catalog-config.xml"
    }
    customer {
      scope = "Customer"
      config = "customer-config.xml"
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  coherence {
    sessions {
      catalog {
        scope = "Catalog"
        config = "catalog-config.xml"
      }
      customer {
        scope = "Customer"
        config = "customer-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "coherence": {
    "sessions": {
      "catalog": {
        "scope": "Catalog",
        "config": "catalog-config.xml"
      },
      "customer": {
        "scope": "Customer",
        "config": "customer-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>In the above example there are two sessions, <code>catalog</code> and <code>customer</code>. The <code>catalog</code> session has a scope name of <code>Catalog</code>, and the <code>customer</code> session` has the scope name <code>Customer</code>.</p>
</div>
<div class="paragraph">
<p>In a client application there might only be a single default session but this session needs to connect to a server that has multiple sessions configured.
In this case the scope name is used to identify the server side session.</p>
</div>
<div class="paragraph">
<p>For example, assuming that the server is using the configuration above, with two sessions, <code>catalog</code> and <code>customer</code>.
The client application only needs to connect to the <code>catalog</code> session, so it can be configured with a default session like this:</p>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">coherence.sessions.default.scope=Catalog
coherence.sessions.default.config=client-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">coherence:
  sessions:
    default:
      scope: Catalog
      config: client-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[coherence]
  [coherence.sessions]
    [coherence.sessions.default]
      scope="Catalog"
      config="client-config.xml"</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">coherence {
  sessions {
    'default' {
      scope = "Catalog"
      config = "client-config.xml"
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  coherence {
    sessions {
      default {
        scope = "Catalog"
        config = "client-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "coherence": {
    "sessions": {
      "default": {
        "scope": "Catalog",
        "config": "client-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_session_type">Session Type</h3>
<div class="paragraph">
<p>There are three different types of session that can be configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>server</code> represents storage enabled cluster member session.</p>
</li>
<li>
<p><code>client</code> represents a storage disabled cluster member or Coherence*Extend client session.</p>
</li>
<li>
<p><code>grpc</code> is a gRPC client session (see the Coherence <a href="https://github.com/oracle/coherence/blob/main/prj/coherence-grpc/README.adoc">gRPC</a> documentation).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The type of the session affects how the bootstrap API starts the session. The session type is configured with the <code>type</code>
property:</p>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">coherence.sessions.default.type=client
coherence.sessions.default.scope=Catalog
coherence.sessions.default.config=client-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">coherence:
  sessions:
    default:
      type: client
      scope: Catalog
      config: client-config.xml</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[coherence]
  [coherence.sessions]
    [coherence.sessions.default]
      type="client"
      scope="Catalog"
      config="client-config.xml"</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">coherence {
  sessions {
    'default' {
      type = "client"
      scope = "Catalog"
      config = "client-config.xml"
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  coherence {
    sessions {
      default {
        type = "client"
        scope = "Catalog"
        config = "client-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "coherence": {
    "sessions": {
      "default": {
        "type": "client",
        "scope": "Catalog",
        "config": "client-config.xml"
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>In this example the default session is a client session.</p>
</li>
</ul>
</div>
</div>

<h1 id="repository"><a class="anchor" href="#repository"></a>5 Micronaut Data with Coherence</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/repository.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut Data is a database access toolkit that uses Ahead of Time (AoT) compilation to pre-compute queries for repository interfaces that are then executed by a thin, lightweight runtime layer.</p>
</div>
<div class="paragraph">
<p>Micronaut Data is inspired by GORM and Spring Data, however improves on those solutions in the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No runtime model - Both GORM and Spring Data maintain a runtime metamodel that uses reflection to model relationships between entities.
This model consumes significant memory and memory requirements grow as your application size grows.
The problem is worse when combined with Hibernate which maintains its own metamodel as you end up with duplicate metamodels.</p>
</li>
<li>
<p>No query translation - Both GORM and Spring Data use regular expressions and pattern matching in combination with runtime generated proxies to translate a method definition on a Java interface into a query at runtime.
No such runtime translation exists in Micronaut Data and this work is carried out by the Micronaut compiler at compilation time.</p>
</li>
<li>
<p>No Reflection or Runtime Proxies - Micronaut Data uses no reflection or runtime proxies, resulting in better performance, smaller stack traces and reduced memory consumption due to a complete lack of reflection caches (Note that the backing implementation, for example Hibernate, may use reflection).</p>
</li>
<li>
<p>Type Safety - Micronaut Data will actively check at compile time that a repository method can be implemented and fail compilation if it cannot.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This integration allows using Coherence as a data source for a Micronaut
<a href="https://micronaut-projects.github.io/micronaut-data/latest/guide/#repositories">repositories</a></p>
</div>
<div class="paragraph">
<p>In addition to the above, this library provides abstract synchronous and asynchronous
<a href="https://micronaut-projects.github.io/micronaut-data/latest/guide/#repositories">repositories</a>
that expose the power of Coherence when not using generated queries.</p>
</div>
<div class="paragraph">
<p>This documentation assumes with principals of Micronaut Data as described <a href="https://micronaut-projects.github.io/micronaut-data/latest/guide/#introduction">here</a>.</p>
</div>

<h2 id="limitations"><a class="anchor" href="#limitations"></a>5.1 Limitations</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/repository/limitations.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>As Coherence is ultimately a key/value store, there are some limitations using the generated query facility offered
by Micronaut.</p>
</div>
<div class="paragraph">
<p>The following auto generated query types/features are not supported</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>JOIN</code></p>
</li>
<li>
<p><code>ORDER BY</code>; the statement will compile, however, it currently has no effect in Coherence&#8217;s query language.  For
the time being, use the APIs offered by the Coherence abstract repository classes.</p>
</li>
<li>
<p>pagination; this means you should not use <code>Page</code> or <code>Slice</code> as return types for such queries</p>
</li>
<li>
<p>When extending the Coherence Data <code>AbstractCoherenceRepository</code> or `AbstractCoherenceAsyncRepository, it <strong>must not</strong>
implement any other Micronaut Data interfaces (e.g., <code>CrudRepository</code>, etc.)</p>
</li>
</ul>
</div>

<h2 id="started"><a class="anchor" href="#started"></a>5.2 Build</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/repository/started.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="sect2">
<h3 id="_gradle">Gradle</h3>
<div class="paragraph">
<p>If you&#8217;re using Gradle for your build, add the following dependencies (in addition to existing micronaut configuration):</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">annotationProcessor("io.micronaut.coherence.data:coherence-data:${version}")
...
implementation("io.micronaut.coherence.data:coherence-data:${version}");
...
testAnnotationProcessor("io.micronaut.coherence.data:coherence-data:${version}")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_maven">Maven</h3>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;dependencies&gt;
  ...
  &lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.coherence&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-coherence-data&lt;/artifactId&gt;
    &lt;version&gt;${version}&lt;/version&gt;
  &lt;/dependency&gt;
  ...
&lt;/dependencies&gt;
...
&lt;plugins&gt;
  ...
  &lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
      &lt;annotationProcessorPaths combine.children="append"&gt;
        &lt;annotationProcessorPath&gt;
          &lt;groupId&gt;io.micronaut.coherence&lt;/groupId&gt;
          &lt;artifactId&gt;micronaut-coherence-processor&lt;/artifactId&gt;
          &lt;version&gt;${version}&lt;/version&gt;
        &lt;/annotationProcessorPath&gt;
      &lt;/annotationProcessorPaths&gt;
      &lt;compilerArgs&gt;
        &lt;arg&gt;-Amicronaut.processing.group=todo.list.micronaut.server
        &lt;/arg&gt;
        &lt;arg&gt;-Amicronaut.processing.module=todo-list-micronaut-server
        &lt;/arg&gt;
      &lt;/compilerArgs&gt;
    &lt;/configuration&gt;
  &lt;/plugin&gt;
  ...
&lt;/plugins&gt;</code></pre>
</div>
</div>
</div>

<h2 id="using"><a class="anchor" href="#using"></a>5.3 Using Micronaut Data</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/repository/using.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="sect2">
<h3 id="_configuration">Configuration</h3>
<div class="paragraph">
<p>Add or update the Coherence configuration to enable Coherence repositories.</p>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">coherence.data.&lt;repository-name&gt;[0].session=&lt;session-name&gt;</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">coherence:
  data:
    &lt;repository-name&gt;:
      [session: &lt;session-name&gt;]</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[coherence]
  [coherence.data]
    [[coherence.data.repository-name]]
      session="&lt;session-name&gt;"</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">coherence {
  data {
    &lt;repositoryName&gt; = [{
        session = "&lt;session-name&gt;"
      }]
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  coherence {
    data {
      &lt;repository-name&gt; = [{
          session = "&lt;session-name&gt;"
        }]
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "coherence": {
    "data": {
      "&lt;repository-name&gt;": [{
          "session": "&lt;session-name&gt;"
        }]
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p><code>&lt;repository-name&gt;</code> maps to the name of the Coherence cache.  The optional <code>session</code> attribute specifies the name
of the Coherence session that should be used to look up the specified cache.  If the <code>session</code> attribute is
omitted, then the default Coherence Session will be assumed.  Review the main
<a href="../bootstrap/configuration.adoc:">documentation</a> for details on configuration sessions.</p>
</div>
<div class="paragraph">
<p>Any repositories that the developer wishes to use with Coherence <strong>must</strong> be annotated with the
<code>@CoherenceRepository</code> annotation.  The value provided to the annotation must match the <code>&lt;repository-name&gt;</code>
identifier within the application configuration.</p>
</div>
<div class="paragraph">
<p>For example, let&#8217;s assume we have a model class representing a Book identified by a UUID.  We can configure something
like the following:</p>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">coherence.data.book=null</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">coherence:
  data:
    book:</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[coherence]
  [coherence.data]</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">coherence {
  data {
    book = null
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  coherence {
    data {
      book = null
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "coherence": {
    "data": {
      "book": null
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As any repository, like <code>book</code> above, that doesn&#8217;t have explicit session configuration, will use the default
Coherence session.  If that&#8217;s the desired configuration, then there is no need reference any repositories within
the configuration.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>and the Java-based Repository could look something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">//...
import io.micronaut.coherence.data.annotation.CoherenceRepository;
import io.micronaut.data.repository.CrudRepository;
//...
@CoherenceRepository("book")
public interface BookRepository extends CrudRepository&lt;Book, UUID&gt; {
//    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>NOTE:</p>
</div>
<div class="paragraph">
<p>The developer may then start adding queries to the interface for Micronaut to implement.</p>
</div>
</div>
<div class="sect2">
<h3 id="_repository_implementations">Repository Implementations</h3>
<div class="paragraph">
<p>While it&#8217;s certainly possible to stick with the Repository interfaces defined by Micronaut (see above), this
integration offers an abstract class that the Repository implementation may extend that exposes features unique to
Coherence.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Don&#8217;t Do This</div>
<div class="paragraph">
<p>When extending the Coherence <code>AbstractCoherenceRepository</code>, developers must not also implement any of the standard
Micronaut
data stereotype interfaces (e.g., <code>CrudRepository</code> and the like).  In fact, this is the recommended approach to
be able to fully utilize Coherence.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">//...
import io.micronaut.coherence.data.annotation.CoherenceRepository;
import io.micronaut.coherence.data.AbstractCoherenceRepository;
//...
@CoherenceRepository("book")
public abstract class CoherenceBookRepository extends AbstractCoherenceRepository&lt;Book, UUID&gt; {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or for an asynchronous repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">//...
import io.micronaut.coherence.data.annotation.CoherenceRepository;
import io.micronaut.coherence.data.AbstractCoherenceAsyncRepository;
//...
@CoherenceRepository("book")
public abstract class CoherenceAsyncBookRepository extends AbstractCoherenceAsyncRepository&lt;Book, UUID&gt; {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Even though developers are restricted in what interfaces they can implement when extending
<code>AbstractCoherenceRepository</code>, it does provide the same features of <code>CrudRepository</code> and more!  We recommend
reviewing the API docs in detail to get a feel of what is offered.</p>
</div>
</div>
<div class="sect2">
<h3 id="_example">Example</h3>
<div class="paragraph">
<p>To see the integration between Coherence and Micronaut Data in action, take a look at the
<a href="https://github.com/coherence-community/todo-list-example/tree/master/java">Todo List example</a>.  The Micronaut section
of the example defines a simple Task model as well as an implementation of <code>AbstractCoherenceRepository</code> that shows
off a few features being offered by the API.</p>
</div>
</div>

<h1 id="injection"><a class="anchor" href="#injection"></a>6 Inject Coherence Resources into Beans</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/injection.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut, and dependency injection in general, make it easy for application classes to declare the dependencies they need and let the runtime provide them when necessary.
This makes the applications easier to develop, test and reason about, and the code extremely clean.</p>
</div>
<div class="paragraph">
<p>Micronaut Coherence allows you to do the same for Coherence objects, such as
<a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/Session.html">Session</a>,
<a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/NamedMap.html">NamedMap</a>,
<a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/NamedCache.html">NamedCache</a>,
<a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/ContinuousQueryCache.html">ContinuousQueryCache</a>,
<a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/ConfigurableCacheFactory.html">ConfigurableCacheFactory</a>,
<a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/Cluster.html">Cluster</a>, etc&#8230;&#8203;</p>
</div>

<h2 id="injectNamedMap"><a class="anchor" href="#injectNamedMap"></a>6.1 Injecting NamedMap & NamedCache</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/injection/injectNamedMap.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Coherence <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/NamedMap.html">NamedMap</a> and <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/NamedCache.html">NamedCache</a> instances can be injected as beans in Micronaut applications.
The mechanics of injecting <code>NamedMap</code> or <code>NamedCache</code> beans is identical, so any use of <code>NamedMap</code> in the examples below can be replaced with <code>NamedCache</code>. Other more specialized forms of <code>NamedMap</code> and <code>NamedCache</code> can also be injected,
for example the asynchronous forms of both classes, and views.</p>
</div>
<div class="paragraph">
<p>The simplest way to inject a <code>NamedMap</code> is to just annotate the injection point with <code>@jakarta.inject.Inject</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
private NamedMap&lt;String, Person&gt; people;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example the injection point field name is used to determine the cache name to inject,
so a <code>NamedMap</code> bean with an underlying cache name of <code>people</code> will be injected.</p>
</div>
<div class="sect1">
<h2 id="_specify_the_mapcache_name">Specify the Map/Cache Name</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes the name of the map or cache being injected needs to be different to the injection point name.
This is always the case when injecting into method parameters as the parameter names are lost by the time the injection point is processed. In this case we can use the <a href="../api/io/micronaut/coherence/annotation/Name.html">@Name</a>
annotation to specify the underlying cache name.</p>
</div>
<div class="paragraph">
<p>The example below will inject a <code>NamedMap</code> that uses an underlying cache named <code>people</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Name("people")
private NamedMap&lt;String, Person&gt; map;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same applies when injecting a constructor or method parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Singleton
public class SomeBean {
    @Inject
    public SomeBean(@Name("people") NamedMap&lt;String, Person&gt; map) {
        // ToDo: initialize the bean...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specify_the_owning_session_name">Specify the Owning Session Name</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Whilst most applications probably use a single Coherence <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/Session.html">Session</a> there are uses-cases where an application may
have multiple sessions. In this case, when injecting a <code>NamedMap</code> the specific session can be specified
by annotating the injection point with <a href="../api/io/micronaut/coherence/annotation/SessionName.html">@SessionName</a>.</p>
</div>
<div class="paragraph">
<p>In the previous examples where no <code>@SessionName</code> was specified Coherence will use the default session to obtain the caches.</p>
</div>
<div class="paragraph">
<p>Assuming the application has multiple sessions configured, one of which is named <code>Catalog</code> the following example
injects a <code>NamedMap</code> from an underlying cache named <code>products</code> in the <code>Catalog</code> session.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@SessionName("Catalog")
@Name("products")
private NamedMap&lt;String, Product&gt; map;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, the same annotation can be used on method parameter injection points.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Controller
public class CatalogController {
    @Inject
    public CatalogController(@SessionName("Catalog") @Name("products")
                             NamedMap&lt;String, Product&gt; products) {
        // ToDo: initialize the bean...
    }
}</code></pre>
</div>
</div>
</div>
</div>

<h2 id="injectAsyncNamedMap"><a class="anchor" href="#injectAsyncNamedMap"></a>6.1.1 Injecting AsyncNamedMap & AsyncNamedCache</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/injection/injectNamedMap/injectAsyncNamedMap.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>It is possible to inject the asynchronous classes <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/AsyncNamedMap.html">AsyncNamedMap</a> and <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/AsyncNamedCache.html">AsyncNamedCache</a> as beans in exactly the same way as described above. Just change the type of the injection point to be <code>AsyncNamedMap</code> or <code>AsyncNamedCache</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Name("people")
private AsyncNamedMap&lt;String, Person&gt; map;</code></pre>
</div>
</div>

<h2 id="injectViews"><a class="anchor" href="#injectViews"></a>6.1.2 Injecting Views (CQC)</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/injection/injectNamedMap/injectViews.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>View (or <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/ContinuousQueryCache.html">ContinuousQueryCache</a>) beans can be injected by specifying the
<a href="../api/io/micronaut/coherence/annotation/View.html">@View</a> annotation at the injection point.
A view is a sub-set of the data in an underlying cache, controlled by a <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/util/Filter.html">Filter</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Name("people")
@View                                    <i class="conum" data-value="1"></i><b>(1)</b>
private NamedMap&lt;String, Person&gt; map;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The injection point has been annotated with <code>@View</code>, so the injected <code>NamedMap</code> will actually be an implementation
of a <code>ContinuousQueryCache</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the above example, no <code>Filter</code> has been specified, so the default behaviour is to use
an <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/util/filter/AlwaysFilter.html">AlwaysFilter</a>.
This means that the view will contain all the entries from the underlying cache (typically a distributed cache).
As a <code>ContinuousQueryCache</code> will hold keys and values locally in deserialized form this can often a better approach
than using a replicated cache.</p>
</div>
<div class="sect1">
<h2 id="_specify_a_view_filter">Specify a View Filter</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Filters are specified for views using a special filter binding annotation.
These are annotations that are themselves annotated with the meta-annotation
<a href="../api/io/micronaut/coherence/annotation/FilterBinding.html">@FilterBinding</a>.
The Micronaut Coherence framework comes with some built in implementations, for example
<a href="../api/io/micronaut/coherence/annotation/AlwaysFilter.html">@AlwaysFilter</a>,
and <a href="../api/io/micronaut/coherence/annotation/WhereFilter.html">@WhereFilter</a>,
and it is simple to implement other as required by applications
(see the <a href="#filterBinding">Filter Binding Annotation</a> section for more details).</p>
</div>
<div class="paragraph">
<p>For example, if there was a cache named "people", containing <code>Person</code> instances, and the application required a view
of that cache just containing <code>People</code> where the <code>lastName</code> attribute is equal to <code>Simpson</code> the <code>@WhereFilter</code>
filter binding annotation could be used to specify the <code>Filter</code>.
The <code>@WhereFilter</code> annotation produces a <code>Filter</code> created from a Coherence CohQL where clause,
in this case <code>lastName == 'Simpson'</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Name("people")
@View
@WhereFilter("lastName = 'Simpson'")
private NamedMap&lt;String, Person&gt; simpsons;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Other built-in or custom filter binding annotations can be used.
Multiple filter-binding annotations can be added to the same injection point to build up more complex
views. The <code>Filter</code> instances produced from each filter binding annotation will all be collected together in
an <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/util/filter/AllFilter.html">AllFilter</a>, which will logically AND then together.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Name("people")
@View
@WhereFilter("lastName = 'Simpson'")
@WhereFilter("age &gt; 10")
private NamedMap&lt;String, Person&gt; simpsons;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The view injected above will be all <code>People</code> with a <code>lastName</code> attribute equal to <code>Simpson</code> and an <code>age</code>
attribute greater than 10. Equivalent to <code>lastName = 'Simpson' &amp;&amp; age &gt; 10</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specify_a_view_transformer">Specify a View Transformer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The values in a view map do not have to be the same as the value sin the underlying cache, a <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/util/ValueExtractor.html">ValueExtractor</a> can be used to transform the actual cache value into a different value in the view.
ValueExtractor are specified for views using a special extractor binding annotation.
These are annotations that are themselves annotated with the meta-annotation
<a href="../api/io/micronaut/coherence/annotation/ExtractorBinding.html">@ExtractorBinding</a>.
The Micronaut Coherence framework comes with some built in implementations, for example
<a href="../api/io/micronaut/coherence/annotation/PropertyExtractor.html">@PropertyExtractor</a>,
and it is simple to implement other as required by applications
(see the <a href="#valueExtractorBinding">Extractor Binding Annotation</a> section for more details).</p>
</div>
<div class="paragraph">
<p>For example, if there was a cache named "people", containing <code>Person</code> instances, and the application required a view where the value was just the <code>age</code> attribute of each <code>Person</code> rather than the whole cache value. A <code>@PropertyExtractor</code> annotation could be used to specify that the values should be transformed using a property extractor.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@View                                       <i class="conum" data-value="1"></i><b>(1)</b>
@Name("people")                             <i class="conum" data-value="2"></i><b>(2)</b>
@PropertyExtractor("age")                   <i class="conum" data-value="3"></i><b>(3)</b>
private NamedMap&lt;String, Integer&gt; ages;     <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@View</code> annotation specifies that a view will be injected rather than a raw <code>NamedMap</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The name of the underlying map for the view is <code>people</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>@PropertyExtractor</code> annotation specifies that a <code>ValueExtractor</code> should be used to transform the underlying cache values into different values in the view. In this case the <code>@PropertyExtractor</code> annotation will produce a value extractor to extract the <code>age</code> property.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Note that the map injected is now a <code>NamedMap&lt;String, Integer&gt;</code> with generic types of <code>String</code> and <code>Integer</code> because the values have been transformed from <code>Person</code> to <code>Integer</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Multiple extractor bindings can be applied to the injection point, in which case the view value will be a <code>List</code> of the extracted attributes.</p>
</div>
<div class="paragraph">
<p>Custom extractor binding annotations can be created to fulfil more complex transformations.</p>
</div>
</div>
</div>

<h2 id="injectNamedTopic"><a class="anchor" href="#injectNamedTopic"></a>6.2 Injecting NamedTopic</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/injection/injectNamedTopic.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Coherence <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/topic/NamedTopic.html">NamedTopic</a>
instances can be injected as beans in Micronaut applications.</p>
</div>
<div class="paragraph">
<p>An alternative way to write message driven applications and <code>TransferEvent`microservices instead of directly injecting `NamedTopic</code>, <code>Publisher</code> or <code>Subscriber</code> beans is to use <a href="#messagingWithTopics">Micronaut Coherence Messaging</a>.</p>
</div>
<div class="paragraph">
<p>The simplest way to inject a <code>NamedTopic</code> is to just annotate the injection point with <code>@jakarta.inject.Inject</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
private NamedTopic&lt;Person&gt; people;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example the injection point field name is used to determine the topic name to inject,
so a <code>NamedTopic</code> bean with an underlying topic name of <code>people</code> will be injected.</p>
</div>
<div class="paragraph">
<p>As an alternative to using a <code>NamedTopic</code> directly in code, Coherence Micronaut also supports annotating methods directly as publishers and subscribers using the same approach as Micronaut Messaging. See the <a href="#messagingWithTopics.adoc">Micronaut Messaging with Coherence Topics</a> section of the documentation.</p>
</div>
<div class="sect1">
<h2 id="_specify_the_topic_name">Specify the Topic Name</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes the name of the topic being injected needs to be different to the injection point name.
This is always the case when injecting into method parameters as the parameter names are lost by the time the injection point is processed. In this case we can use the <a href="../api/io/micronaut/coherence/annotation/Name.html">@Name</a>
annotation to specify the underlying cache name.</p>
</div>
<div class="paragraph">
<p>The example below will inject a <code>NamedTopic</code> that uses an underlying topic named <code>orders</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Name("people")
private NamedTopic&lt;Order&gt; orders;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same applies when injecting a constructor or method parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Singleton
public class SomeBean {
    @Inject
    public SomeBean(@Name("orders") NamedTopic&lt;Order&gt; topic) {
        // ToDo:
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specify_the_session_name">Specify the Session Name</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Whilst most applications probably use a single Coherence <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/Session.html">Session</a> there are uses-cases where an application may
have multiple sessions. In this case, when injecting a <code>NamedTopic</code> the specific session can be specified
by annotating the injection point with <a href="../api/io/micronaut/coherence/annotation/SessionName.html">@SessionName</a>.</p>
</div>
<div class="paragraph">
<p>In the previous examples where no <code>@SessionName</code> was specified Coherence will use the default session to obtain the caches.</p>
</div>
<div class="paragraph">
<p>For example, assume the application has multiple sessions configured, one of which is named <code>Customers</code>
For example, assume the application has multiple sessions configured, one of which is named <code>Customers</code>
the following code snippet injects a <code>NamedTopic</code> using an underlying topic named <code>orders</code> in the <code>Customers</code> session.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@SessionName("Customers")
@Name("orders")
private NamedTopic&lt;Order&gt; topic;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, the same annotation can be used on method parameter injection points.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Controller
public class OrderProcessor {
    @Inject
    public OrderProcessor(@SessionName("Customers") @Name("orders")
                          NamedTopic&lt;Order&gt; orders) {
        // ToDo:
    }
}</code></pre>
</div>
</div>
</div>
</div>

<h2 id="injectTopicPublisher"><a class="anchor" href="#injectTopicPublisher"></a>6.2.1 Injecting a NamedTopic Publisher</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/injection/injectNamedTopic/injectTopicPublisher.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>If application code only needs to publish messages to a Coherence <code>NamedTopic</code> then instead of injecting a
<code>NamedTopic</code> bean, a <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/topic/Publisher.html">Publisher</a> bean can be injected.</p>
</div>
<div class="paragraph">
<p>The simplest way to inject a <code>Publisher</code> is just to annotate the injection point of type <code>Publisher</code> with <code>@Inject</code>,
for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
private Publisher&lt;Order&gt; orders;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example above will inject a <code>Publisher</code> bean, the name of the underlying <code>NamedTopic</code> will be taken from the
name of the injection point, in this case <code>orders</code>.</p>
</div>
<div class="sect1">
<h2 id="_specify_the_topic_name">Specify the Topic Name</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If the name of the injection point cannot be used as the <code>NamedTopic</code> name, which is always the case with injection points that are method or constructor parameters, then the <a href="../api/io/micronaut/coherence/annotation/Name.html">@Name</a> annotation can be used to specify the topic name.</p>
</div>
<div class="paragraph">
<p>For example, both of the code snippets below inject a <code>Publisher</code> that published to the <code>orders</code> topic:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Name("orders")
private Publisher&lt;Order&gt; orders;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Controller
public class OrderController {
    @Inject
    public OrderController(@Name("orders") Publisher&lt;Order&gt; topic) {
        // ToDo:
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specify_the_owning_session">Specify the Owning Session</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As with injection of <code>NamedTopics</code>, in applications using multiple <code>Session</code> instances, the name of the <code>Session</code> that
owns the underlying <code>NamedTopic</code> can be specified when injecting a <code>Publisher</code> by adding the
<a href="../api/io/micronaut/coherence/annotation/SessionName.html">@SessionName</a> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Name("orders")
@SessionName("Customers")
private Publisher&lt;Order&gt; orders;</code></pre>
</div>
</div>
</div>
</div>

<h2 id="injectTopicSubscriber"><a class="anchor" href="#injectTopicSubscriber"></a>6.2.2 Injecting a NamedTopic Subscriber</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/injection/injectNamedTopic/injectTopicSubscriber.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>If application code only needs to subscribe to messages from a Coherence <code>NamedTopic</code> then instead of injecting a
<code>NamedTopic</code> bean, a <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/topic/Subscriber.html">Subscriber</a> bean can be injected.</p>
</div>
<div class="paragraph">
<p>The simplest way to inject a <code>Subscriber</code> is just to annotate the injection point of type <code>Subscriber</code> with <code>@Inject</code>,
for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
private Subscriber&lt;Order&gt; orders;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example above will inject a <code>Subscriber</code> bean, the name of the underlying <code>NamedTopic</code> will be taken from the
name of the injection point, in this case <code>orders</code>.</p>
</div>
<div class="sect1">
<h2 id="_specify_the_topic_name">Specify the Topic Name</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If the name of the injection point cannot be used as the <code>NamedTopic</code> name, which is always the case with injection points that are method or constructor parameters, then the <a href="../api/io/micronaut/coherence/annotation/Name.html">@Name</a> annotation can be used to specify the topic name.</p>
</div>
<div class="paragraph">
<p>For example, both of the code snippets below inject a <code>Subscriber</code> that subscribe to the <code>orders</code> topic:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Name("orders")
private Subscriber&lt;Order&gt; orders;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Controller
public class OrderController {
    @Inject
    public OrderController(@Name("orders") Subscriber&lt;Order&gt; topic) {
        // ToDo:
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specify_the_owning_session">Specify the Owning Session</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As with injection of <code>NamedTopics</code>, in applications using multiple <code>Session</code> instances, the name of the <code>Session</code> that
owns the underlying <code>NamedTopic</code> can be specified when injecting a <code>Subscriber</code> by adding the
<a href="../api/io/micronaut/coherence/annotation/SessionName.html">@SessionName</a> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Name("orders")
@SessionName("Customers")
private Subscriber&lt;Order&gt; orders;</code></pre>
</div>
</div>
</div>
</div>

<h2 id="injectTopicSubscriberFiltered"><a class="anchor" href="#injectTopicSubscriberFiltered"></a>6.2.2.1 Filtering Topic Messages</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/injection/injectNamedTopic/injectTopicSubscriber/injectTopicSubscriberFiltered.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>A <code>Subscriber</code> can filter the messages that it receives from the <code>NamedTopic</code> by using a
<a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/util/Filter.html">Filter</a>.
Filtering of messages takes place on the server, so for use cases where the application is only interested in a sub-set of messages, this can be more efficient than bringing all messages back to the client for processing.</p>
</div>
<div class="paragraph">
<p>Filters are specified for a <code>Subscriber</code> using a special filter binding annotation.
These are annotations that are themselves annotated with the meta-annotation
<a href="../api/io/micronaut/coherence/annotation/FilterBinding.html">@FilterBinding</a>.
The Micronaut Coherence framework comes with some built in implementations, for example
<a href="../api/io/micronaut/coherence/annotation/AlwaysFilter.html">@AlwaysFilter</a>,
and <a href="../api/io/micronaut/coherence/annotation/WhereFilter.html">@WhereFilter</a>,
and it is simple to implement other as required by applications
(see the <a href="#filterBinding">Filter Binding Annotation</a> section for more details).</p>
</div>
<div class="paragraph">
<p>For example, both of the code snippets below inject a <code>Subscriber</code> that subscribe to the <code>orders</code> topic,
but only receives <code>Order</code> messages where the <code>productId</code> attribute is <code>AB1234</code>.
the <code>@WhereFilter</code> filter binding annotation is used to specify the <code>Filter</code>, as <code>@WhereFilter</code> takes a Coherence
CohQL where clause and converts it to a <code>Filter</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Name("orders")
@WhereFilter("productId = 'AB1234'")
private Subscriber&lt;Order&gt; orders;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Controller
public class OrderController {
    @Inject
    public OrderController(@Name("orders") @WhereFilter("productId = 'AB1234'") Subscriber&lt;Order&gt; topic) {
        // ToDo:
    }
}</code></pre>
</div>
</div>

<h2 id="injectTopicSubscriberTransformed"><a class="anchor" href="#injectTopicSubscriberTransformed"></a>6.2.2.2 Transforming Topic Messages</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/injection/injectNamedTopic/injectTopicSubscriber/injectTopicSubscriberTransformed.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>A <code>Subscriber</code> can be configured to receive just a part of a <code>NamedTopic</code> message using a
<a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/util/ValueExtractor.html">ValueExtractor</a>.
The message transformation happens on the server so in use-cases where a <code>Subscriber</code> only requires a part of a message, it can be much more efficient to extract the required parts on the server instead of bringing the full payload back to the client.</p>
</div>
<div class="paragraph">
<p>ValueExtractors are specified for a <code>Subscriber</code> using a special extractor binding annotation.
These are annotations that are themselves annotated with the meta-annotation
<a href="../api/io/micronaut/coherence/annotation/ExtractorBinding.html">@ExtractorBinding</a>.
The Micronaut Coherence framework comes with some built in implementations, for example
<a href="../api/io/micronaut/coherence/annotation/PropertyExtractor.html">@PropertyExtractor</a>,
and <a href="../api/io/micronaut/coherence/annotation/PofExtractor.html">@PofExtractor</a>,
and it is simple to implement other as required by applications
(see the <a href="#valueExtractorBinding">Extractor Binding Annotation</a> section for more details).</p>
</div>
<div class="paragraph">
<p>For example, assuming that there is a topic named <code>orders</code> containing <code>Order</code> instances as the payload.
If a <code>Subscriber</code> is required to subscribe to the <code>orders</code> topic, but only needs to receive the <code>productId</code> values,
then a <code>@PropertyExtractor</code> annotation could be used. A <code>@PropertyExtractor</code> specifies the name of a property to extract.</p>
</div>
<div class="paragraph">
<p>Both code snippets below will inject a <code>Subscriber</code> that just receives the <code>productId</code> property of <code>Orders</code> objects
from the <code>orders</code> topic.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
@Name("orders")
@PropertyExtractor("productId")
private Subscriber&lt;Order&gt; orders;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Controller
public class OrderController {
    @Inject
    public OrderController(@Name("orders") @PropertyExtractor("productId")
                           Subscriber&lt;Order&gt; topic) {
        // ToDo:
    }
}</code></pre>
</div>
</div>

<h2 id="injectSession"><a class="anchor" href="#injectSession"></a>6.3 Injecting a Session</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/injection/injectSession.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Sometimes it might not be possible to inject a Coherence resource, such as <code>NamedMap</code> or <code>NamedCache</code> directly because
the name of the resource to be injected is not known until runtime. In this case it makes sense to inject a
<a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/Session.html">Session</a> instance which can then be used to obtain other resources.</p>
</div>
<div class="paragraph">
<p>The simplest way to inject a <code>Session</code> is just to annotate a field, method parameter, or other injection point.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Controller
public class MyBean {
    @Inject
    private Session session;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or into a constructor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Controller
public class MyBean {
    @Inject
    public MyBean(Session session) {
        // ToDo...
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both examples above will inject the default <code>Session</code> instance into the injection point.</p>
</div>
<div class="sect1">
<h2 id="_specify_a_session_name">Specify a Session Name</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For most applications that only use a single <code>Session</code> the simple examples above will be all that is required.
Some applications though may use multiple named <code>Session</code> instances, in which case the <code>Session</code> name need to
be specified.
This can be done by adding the <a href="../api/io/micronaut/coherence/annotation/Name.html">@Name</a> annotation to the injection point.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Controller
public class MyBean {
    @Inject
    @Name("Catalog")
    private Session session;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or into a constructor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Controller
public class MyBean {
    @Inject
    public MyBean(@Name("Catalog") Session session) {
        // ToDo...
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In both examples above the <code>Session</code> injected will be the <code>Catalog</code> session.
The named <code>Session</code> must have previously been configured when <a href="#bootstrap">bootstrapping Coherence</a>.</p>
</div>
</div>
</div>

<h1 id="events"><a class="anchor" href="#events"></a>7 Events</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Event driven patterns are a common way to build scalable applications and microservices.
Coherence produces a number of events that can be used by applications to respond to data changes and other actions in Coherence.</p>
</div>
<div class="paragraph">
<p>There are two types of events in Coherence. There are <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/util/MapEvent.html">MapEvents</a>,
that in a traditional Coherence application are subscribed to using <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/util/MapListener.html">MapListener</a> and there are a number of different types of <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/Event.html">Event</a>, that are in a traditional Coherence application are subscribed to using an <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/EventInterceptor.html">EventInterceptor</a>.</p>
</div>
<div class="paragraph">
<p>Micronaut makes subscribing to both of these event types much simpler, using observer methods annotated with
<a href="../api/io/micronaut/coherence/annotation/CoherenceEventListener.html">@CoherenceEventListener</a>.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
void onEvent(CoherenceLifecycleEvent event) {
    // ToDo: process event...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The method above receives all events of type <code>CoherenceLifecycleEvent</code> emitted during the lifetime of the application.</p>
</div>
<div class="paragraph">
<p>The actual events received can be controlled further by annotating the method or parameter.</p>
</div>

<h2 id="mapEvents"><a class="anchor" href="#mapEvents"></a>7.1 MapEvent Listeners</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/mapEvents.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Listening for changes to data in Coherence is a common use case in applications.
Typically, this involves creating an implementation of a <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/util/MapListener.html">MapListener</a>
 and adding that listener to a <code>NamedMap</code> or <code>NamedCache</code>. Using Coherence Micronaut makes this much simpler by just requiring Micronaut beans with suitably annotated observer methods that will receive events.</p>
</div>
<div class="sect2">
<h3 id="_mapevent_observer_methods">MapEvent Observer Methods</h3>
<div class="paragraph">
<p>A <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/util/MapEvent.html">MapEvent</a> observer method is a method on a Micronaut bean that is annotated with <a href="../api/io/micronaut/coherence/annotation/CoherenceEventListener.html">@CoherenceEventListener</a>. The method has a <code>void</code> return type and takes a single method parameter of type <code>MapEvent</code>, typically this has the generic types of the underlying map/cache key and value.</p>
</div>
<div class="paragraph">
<p>For example, assuming that there is a map/cache named <code>people</code>, with keys of type <code>String</code> and values of type <code>Person</code>, and the application has logic that should be executed each time a new <code>Person</code> is inserted into the map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import com.tangosol.util.MapEvent;
import io.micronaut.coherence.annotation.*;

@Controller                                                    <i class="conum" data-value="1"></i><b>(1)</b>
public class PersonController {

    @CoherenceEventListener                                    <i class="conum" data-value="2"></i><b>(2)</b>
    public void onNewPerson(@MapName("people")                 <i class="conum" data-value="3"></i><b>(3)</b>
                            @Inserted                          <i class="conum" data-value="4"></i><b>(4)</b>
                            MapEvent&lt;String, Person&gt; event) {
        // ToDo: process the event
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>PersonController</code> is a simple Micronaut bean, in this case a <code>Controller</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>onNewPerson</code> method is annotated with <code>@CoherenceEventListener</code> making it a Coherence event listener.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>@MapName("people")</code> annotation specifies the name of the map to receive events from, in this case <code>people</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>@Inserted</code> annotation specified that only <code>Inserted</code> events should be sent to this method.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The above example is very simple, there are a number of other annotations that control what events are received from where.</p>
</div>
</div>
<div class="sect2">
<h3 id="_specify_the_mapcache_name">Specify the Map/Cache name</h3>
<div class="paragraph">
<p>By default, a <code>MapEvent</code> observer method would receive events for all maps/caches.
In practice though, this would not be a very common use case and normally an observer method would be for a specific cache.</p>
</div>
<div class="paragraph">
<p>The Coherence Micronaut API contains two annotations for specifying the map name <a href="../api/io/micronaut/coherence/annotation/MapName.html">@MapName</a>, or cache name <a href="../api/io/micronaut/coherence/annotation/CacheName.html">@CacheName</a>.
Both annotations take a single <code>String</code> value that is the name of the map or cache that events should be received from.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(MapEvent&lt;String, String&gt; event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above method receives events for <em>all</em> caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@MapName("foo")  <i class="conum" data-value="1"></i><b>(1)</b>
                    MapEvent&lt;String, String&gt; event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The above method receives events for the map named <code>foo</code>.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@CacheName("foo")  <i class="conum" data-value="1"></i><b>(1)</b>
                    MapEvent&lt;String, String&gt; event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The above method receives events for the cache named <code>bar</code>.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_specify_the_cache_service_name">Specify the Cache Service name</h3>
<div class="paragraph">
<p>As well as restricting the received events to a specific map or cache name, events can be restricted to only events from a specific cache service. In Coherence all caches are owned by a cache service, which have a unique  name.
By default, a <code>MapEvent</code> observer method would receive events for a matching cache name on all services.
If an applications Coherence configuration has multiple services, the events can be restricted to just specific services using the <a href="../api/io/micronaut/coherence/annotation/ServiceName.html">@ServiceName</a> annotation.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@MapName("foo")  <i class="conum" data-value="1"></i><b>(1)</b>
                    MapEvent&lt;String, String&gt; event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The above method receives events for the map named <code>foo</code> on <em>all</em> cache services.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@MapName("foo")
                    @ServiceName("Storage")  <i class="conum" data-value="1"></i><b>(1)</b>
                    MapEvent&lt;String, String&gt; event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The above method receives events for the cache named <code>foo</code> owned by the cache service named <code>Storage</code>.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@ServiceName("Storage")  <i class="conum" data-value="1"></i><b>(1)</b>
                    MapEvent&lt;String, String&gt; event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The above method receives events for the <em>all</em> caches owned by the cache service named <code>Storage</code> as there is no <code>@MapName</code> or <code>@CacheName</code> annotation.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_specify_the_owning_session_name">Specify the Owning Session name</h3>
<div class="paragraph">
<p>In applications that use multiple <code>Sessions</code> there may be a situation where more than one session has a map with the same name, and an observer method needs to restrict the events it receives to a specific session.
The events can be restricted to <code>maps</code> and/or <code>caches</code> in specific sessions using the <a href="../api/io/micronaut/coherence/annotation/SessionName.html">@SessionName</a> annotation.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@MapName("orders")  <i class="conum" data-value="1"></i><b>(1)</b>
                    MapEvent&lt;String, String&gt; event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The above method receives events for the map named <code>orders</code> in <em>all</em> sessions.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@MapName("orders")
                    @SessionName("Customer")  <i class="conum" data-value="1"></i><b>(1)</b>
                    MapEvent&lt;String, Order&gt; event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The above method receives events for the map named <code>orders</code> owned by the <code>Session</code> named <code>Customer</code>.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@SessionName("Customer")  <i class="conum" data-value="1"></i><b>(1)</b>
                    MapEvent&lt;String, Order&gt; event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The above method receives events for the <em>all</em> caches owned by the <code>Session</code> named <code>Customer</code> as there is no <code>@MapName</code> or <code>@CacheName</code> annotation.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In an application with multiple sessions, events can be routed by session, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onCustomerOrders(@SessionName("Customer")  <i class="conum" data-value="1"></i><b>(1)</b>
                             @MapName("orders")
                             MapEvent&lt;String, Order&gt; event) {
    // ToDo: process the event
}

@CoherenceEventListener
public void onCatalogOrders(@SessionName("Catalog")   <i class="conum" data-value="2"></i><b>(2)</b>
                            @MapName("orders")
                            MapEvent&lt;String, Order&gt; event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>onCustomerOrders</code> will receive events for the <code>orders</code> map owned by the <code>Session</code> named <code>Customer</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>onCatalogOrders</code> will receive events for the <code>orders</code> map owned by the <code>Session</code> named <code>Catalog</code>.</td>
</tr>
</table>
</div>
</div>

<h2 id="eventTypes"><a class="anchor" href="#eventTypes"></a>7.1.1 Receive Specific Event Types</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/mapEvents/eventTypes.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>There are three types of event that a <code>MapEvent</code> observer method can receive, <code>Insert</code>, <code>Update</code> and <code>Delete</code>.
By default, an observer method will receive all events for the map (or maps) it applies to.
This can be controlled using the following annotations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../api/io/micronaut/coherence/annotation/Inserted.html">@Inserted</a> - to receive <code>Insert</code> events.</p>
</li>
<li>
<p><a href="../api/io/micronaut/coherence/annotation/Updated.html">@Updated</a> - to receive <code>Update</code> events.</p>
</li>
<li>
<p><a href="../api/io/micronaut/coherence/annotation/Deleted.html">@Deleted</a> - to receive <code>Delete</code> events.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Zero or more of the above annotations can be used to annotate the <code>MapEvent</code> parameter of the observer method.</p>
</div>
<div class="paragraph">
<p>For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@MapName("test")
                    @Inserted        <i class="conum" data-value="1"></i><b>(1)</b>
                    MapEvent&lt;String, String&gt; event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Only <code>Insert</code> events for the map <code>test</code> will be received.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@MapName("test")
                    @Inserted @Deleted       <i class="conum" data-value="1"></i><b>(1)</b>
                    MapEvent&lt;String, String&gt; event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Only <code>Insert</code> and <code>Delete</code> events for the map <code>test</code> will be received.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@MapName("test") MapEvent&lt;String, String&gt; event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All events for the map <code>test</code> will be received.</p>
</div>

<h2 id="filteringEvents"><a class="anchor" href="#filteringEvents"></a>7.1.2 Filtering Events</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/mapEvents/filteringEvents.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>The <code>MapEvents</code> received by an observer method can be further restricted by applying a filter.
Filters are applied by annotating the method with a <a href="#filterBinding">filter binding</a> annotation, which is a link to a factory that creates a specific instance of a <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/util/Filter.html">Filter</a>.
Event filters applied in this way are executed on the server, which can make receiving events more efficient for clients as the event will not be sent from the server at all.</p>
</div>
<div class="paragraph">
<p>The Micronaut Coherence framework comes with some built in implementations, for example
<a href="../api/io/micronaut/coherence/annotation/AlwaysFilter.html">@AlwaysFilter</a>,
and <a href="../api/io/micronaut/coherence/annotation/WhereFilter.html">@WhereFilter</a>,
and it is simple to implement other as required by applications
(see the <a href="#filterBinding">Filter Binding Annotation</a> section for more details).</p>
</div>
<div class="paragraph">
<p>For example, assume there is a map named <code>people</code> with keys of type <code>String</code> and values of type <code>People</code>, and an observer method needs to receive events for all values where the <code>age</code> property is <code>18</code> or over.
A custom filter binding annotation could be written to create the required <code>Filter</code>, but as the condition is very simple, in this example the built in <code>@WhereFilter</code> filter binding annotation will be used with a where clause of <code>age &gt;= 18</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@WhereFilter("age &gt;= 18")     <i class="conum" data-value="1"></i><b>(1)</b>
@CoherenceEventListener
@MapName("people")
public void onAdult(MapEvent&lt;String, Person&gt; people) {
    // ToDo: process event...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@WhereFilter</code> annotation is applied to the method.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>onAdult</code> method above will receive all events emitted from the <code>people</code> map, but only for entries where the value of the <code>age</code> property of the entry value is <code>&gt;= 18</code>.</p>
</div>

<h2 id="transformingEvents"><a class="anchor" href="#transformingEvents"></a>7.1.3 Transforming Events</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/mapEvents/transformingEvents.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>In some use-cases the <code>MapEvent</code> observer method does not require the whole map or cache value to process, it might only require one, or a few, properties of the value, or it might require some calculated value. This can be achieved by using an event transformer to transform the values that will be received by the observer method. The transformation takes place on the server before the event is emitted to the method. This can improve efficiency on a client in cases where the cache value is large but the client only requires a small part of that value because only the required values are sent over the wire to the client.</p>
</div>
<div class="paragraph">
<p>In the Coherence Micronaut framework, event values are transformed using a <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/util/ValueExtractor.html">ValueExtractor</a>. A <code>ValueExtractor</code> is a simple interface that takes in one value and transforms it into another value. The <code>ValueExtractor</code> is applied to the event value; events contain both a new and old values and the extractor is applied to both as applicable. For <code>Insert</code> events there is only a new value, for <code>Update</code> events there will be both a new and old value and for <code>Delete</code> events there will only be an old value. The extractor is not applied to the event key.</p>
</div>
<div class="paragraph">
<p>The <code>ValueExtractor</code> to use for a <code>MapEvent</code> observer method is indicated by annotating the method with an <a href="#valueExtractorBinding">extractor binding annotation</a>. An extractor binding is an annotation that is itself annotated with the meta-annotation <a href="../api/io/micronaut/coherence/annotation/ExtractorBinding.html">@ExtractorBinding</a>.
The extractor binding annotation is a link to a corresponding <a href="../api/io/micronaut/coherence/ExtractorFactory.html">ExtractorFactory</a> that will build an instance of a <code>ValueExtractor</code>.</p>
</div>
<div class="paragraph">
<p>For example, assuming that there is a <code>NamedMap</code> with the name <code>orders</code> that has keys of type <code>String</code> and values of type <code>Order</code>; the <code>Order</code> class has a <code>customerId</code> property of type <code>String</code>. A <code>MapEvent</code> observer method is only interested in the <code>customerId</code> for an order so the built-in extractor binding annotation <a href="../api/io/micronaut/coherence/annotation/PropertyExtractor.html">@PropertyExtractor</a> can be used to just extract the <code>customerId</code> from the event:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
@PropertyExtractor("customerId")                        <i class="conum" data-value="1"></i><b>(1)</b>
public void onOrder(@MapName("orders")                  <i class="conum" data-value="2"></i><b>(2)</b>
                    MapEvent&lt;String, String&gt; event) {   <i class="conum" data-value="3"></i><b>(3)</b>
    // ToDo: process event...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The method is annotated with <code>@PropertyExtractor</code> to indicate that a <code>ValueExtractor</code> that just extracts the <code>customerId</code> property should be used to transform the event.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The map name to receive events from is set to <code>orders</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Note that the generic types of the <code>MapEvent</code> parameter are now <code>MapEvent&lt;String, String&gt;</code> instead of <code>MapEvent&lt;String, Order&gt;</code> because the event values will have been transformed from an <code>Order</code> into just the <code>String</code> <code>customerId</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is possible to apply multiple filter binding annotations to a method. In this case the extractors are combined into a Coherence <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/util/extractor/ChainedExtractor.html">ChainedExtractor</a>, which will return the extracted values as a <code>java.util.List</code>.</p>
</div>
<div class="paragraph">
<p>Expanding on the example above, if the <code>Order</code> class also has an <code>orderId</code> property of type <code>Long</code>, and an observer method, only interested in <code>Insert</code> events needs both the <code>customerId</code> and <code>orderId</code>, then the method can be annotated with an two <code>@PropertyExtractor</code> annotations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
@PropertyExtractor("customerId")                     <i class="conum" data-value="1"></i><b>(1)</b>
@PropertyExtractor("orderId")
public void onOrder(@Inserted                        <i class="conum" data-value="2"></i><b>(2)</b>
                    @MapName("orders")
                    MapEvent&lt;String, List&lt;Object&gt;&gt; event) {  <i class="conum" data-value="3"></i><b>(3)</b>
    List list = event.getNewValue();
    String customerId = (String) list.get(0);        <i class="conum" data-value="4"></i><b>(4)</b>
    Long orderId = (Long) list.get(1);
    // ...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The method is annotated with two <code>@PropertyExtractor</code> annotations, one to extract <code>customerId</code> and one to extract <code>orderId</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The method parameter is annotated with <code>@Inserted</code> so that the method only receives <code>Insert</code> events.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>MapEvent</code> parameter not has a key of type <code>String</code> and a value of type <code>List&lt;Object&gt;</code>, because the values from the multiple extractors will be returned in a <code>List</code>. We cannot use a generic value narrower than <code>Object</code> for the list because it will contain a <code>String</code> and a <code>Long</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The extracted values can be obtained from the list, they will be in the same order that the annotations were applied to the method.</td>
</tr>
</table>
</div>

<h2 id="coherenceEvents"><a class="anchor" href="#coherenceEvents"></a>7.2 Coherence Event Interceptors</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/coherenceEvents.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Coherence produces many events in response to various serverside and client side actions. For example, Lifecycle events for Coherence itself, maps and cache, Entry events when data in maps and caches changes, Partition events for partition lifecycle and distribution, EntryProcessor events when invoked on a map or cache, etc.
In a stand-alone Coherence application these events are subscribed to using a <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/EventInterceptor.html">EventInterceptor</a> implementation registered to listen to specific event types.</p>
</div>
<div class="paragraph">
<p>The Coherence Micronaut API makes subscribing to these events much simpler, by using the same approach used for Micronaut events, namely annotated event observer methods.
A Coherence event observer method is a method annotated with <a href="../api/io/micronaut/coherence/annotation/CoherenceEventListener.html">@CoherenceEventListener</a> that has a <code>void</code> return type and a single parameter of the type of event to be received.
The exact events received can be further controlled by applying other annotations to the method or event parameter.
The annotations applied will vary depending on the type of the event.</p>
</div>
<div class="sect2">
<h3 id="_event_types">Event Types</h3>
<div class="paragraph">
<p>The different types of event that can be observed are listed below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/CoherenceLifecycleEvent.html">CoherenceLifecycleEvent</a> - lifecycle events for  <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/Coherence.html">Coherence</a> instances</p>
</li>
<li>
<p><a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/SessionLifecycleEvent.html">SessionLifecycleEvent</a> - lifecycle events for <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/Session.html">Session</a> instances</p>
</li>
<li>
<p><a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/application/LifecycleEvent.html">LifecycleEvent</a> - lifecycle events for <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/ConfigurableCacheFactory.html">ConfigurableCacheFactory</a> instances</p>
</li>
<li>
<p><a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/cache/CacheLifecycleEvent.html">CacheLifecycleEvent</a> - lifecycle events for <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/NamedMap.html">NamedMap</a> and <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/NamedCache.html">NamedCache</a> instances</p>
</li>
<li>
<p><a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/cache/EntryEvent.html">EntryEvent</a> - events emitted by the mutation of entries in a <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/NamedMap.html">NamedMap</a> or <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/NamedCache.html">NamedCache</a></p>
</li>
<li>
<p><a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/cache/EntryProcessorEvent.html">EntryProcessorEvent</a> - events emitted by the invocation of an <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/util/EntryProcessor.html">EntryProcessor</a> on entries in a <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/NamedMap.html">NamedMap</a> or <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/NamedCache.html">NamedCache</a></p>
</li>
<li>
<p><a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/TransactionEvent.html">TransactionEvent</a> - events pertaining to all mutations performed within the context of a single request in a partition of a <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/NamedMap.html">NamedMap</a> or <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/NamedCache.html">NamedCache</a>, also referred to as "partition level transactions".</p>
</li>
<li>
<p><a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/TransferEvent.html">TransferEvent</a> - captures information concerning the transfer of a partition for a storage enabled member.</p>
</li>
<li>
<p><a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/UnsolicitedCommitEvent.html">UnsolicitedCommitEvent</a> - captures changes pertaining to all observed mutations performed against caches that were not directly caused (solicited) by the partitioned service. These events may be due to changes made internally by the backing map, such as eviction, or referrers of the backing map causing changes.</p>
</li>
<li>
<p>If using commercial versions of Coherence with the Coherence Micronaut framework, there are also events associated to the federation of data between different clusters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most of the events above only apply on storage enabled cluster members. For example, an <code>EntryEvent</code> will only be emitted for mutation of an entry on the storage enabled cluster member that owns that entry. Whereas lifecycle events may be emitted on all members, such as <code>CacheLifecycle</code> event that may be emitted on any member when a cache is created, truncated, or destroyed.</p>
</div>
</div>

<h2 id="coherenceLifecycleEvent"><a class="anchor" href="#coherenceLifecycleEvent"></a>7.2.1 Coherence Lifecycle Events</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/coherenceEvents/coherenceLifecycleEvent.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/CoherenceLifecycleEvent.html">CoherenceLifecycleEvents</a> are emitted to indicate the lifecycle of a <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/Coherence.html">Coherence</a> instance.</p>
</div>
<div class="paragraph">
<p>To subscribe to <code>CoherenceLifecycleEvent</code> simply create a Micronaut bean with a listener method annotated with <a href="../api/io/micronaut/coherence/annotation/CoherenceEventListener.html">@CoherenceEventListener</a>.
The method should have a single parameter of type <code>CoherenceLifecycleEvent</code>.</p>
</div>
<div class="paragraph">
<p><code>CoherenceLifecycleEvent</code> are emitted by <code>Coherence</code> instances and will only be received in the same JVM, which could be a cluster member or a client.</p>
</div>
<div class="paragraph">
<p>For example, the <code>onEvent</code> method below will receive lifecycle events for all <code>Coherence</code> instances in the current application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(CoherenceLifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_receive_specific_coherencelifecycleevent_types">Receive Specific CoherenceLifecycleEvent Types</h3>
<div class="paragraph">
<p>There are four different types of <code>CoherenceLifecycleEvent</code>.
By adding the corresponding annotation to the method parameter the method will only receive the specified events.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Starting - a <code>Coherence</code> instance is about to start, use the <a href="../api/io/micronaut/coherence/annotation/Starting.html">@Starting</a> annotation</p>
</li>
<li>
<p>Started - a <code>Coherence</code> instance has started, use the <a href="../api/io/micronaut/coherence/annotation/Started.html">@Started</a> annotation</p>
</li>
<li>
<p>Stopping - a <code>Coherence</code> instance is about to stop, use the <a href="../api/io/micronaut/coherence/annotation/Stopping.html">@Stopping</a> annotation</p>
</li>
<li>
<p>Stopped - a <code>Coherence</code> instance has stopped, use the <a href="../api/io/micronaut/coherence/annotation/Stopped.html">@Stopped</a> annotation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the method below will only receive <code>Started</code> and <code>Stopped</code> events.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@Started @Stopped CoherenceLifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_receive_coherencelifecycleevents_for_a_specific_coherence_instance">Receive CoherenceLifecycleEvents for a Specific Coherence Instance</h3>
<div class="paragraph">
<p>Each <code>Coherence</code> instance in an application has a unique name. The observer method can be annotated to only receive events associated with a specific <code>Coherence</code> instance by using the <a href="../api/io/micronaut/coherence/annotation/Name.html">@Name</a> annotation.</p>
</div>
<div class="paragraph">
<p>For example, the method below will only receive events for the <code>Coherence</code> instance named <code>customers</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@Name("customers") CoherenceLifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The method in this example will receive events for the default <code>Coherence</code> instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@Name(Coherence.DEFAULT_NAME) CoherenceLifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>

<h2 id="sessionLifecycleEvent"><a class="anchor" href="#sessionLifecycleEvent"></a>7.2.2 Session Lifecycle Events</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/coherenceEvents/sessionLifecycleEvent.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/SessionLifecycleEvent.html">SessionLifecycleEvents</a> are emitted to indicate the  lifecycle event of a <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/Session.html">Session</a> instance.</p>
</div>
<div class="paragraph">
<p>To subscribe to <code>SessionLifecycleEvent</code> simply create a Micronaut bean with a listener method annotated with <a href="../api/io/micronaut/coherence/annotation/CoherenceEventListener.html">@CoherenceEventListener</a>.
The method should have a single parameter of type <code>SessionLifecycleEvent</code>.</p>
</div>
<div class="paragraph">
<p><code>SessionLifecycleEvent</code> are emitted by <code>Session</code> instances and will only be received in the same JVM, which could be a cluster member or a client.</p>
</div>
<div class="paragraph">
<p>For example, the <code>onEvent</code> method below will receive lifecycle events for all <code>Session</code> instances in the current application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(SessionLifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_receive_specific_sessionlifecycleevent_types">Receive Specific SessionLifecycleEvent Types</h3>
<div class="paragraph">
<p>There are four different types of <code>SessionLifecycleEvent</code>.
By adding the corresponding annotation to the method parameter the method will only receive the specified events.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Starting - a <code>Coherence</code> instance is about to start, use the <a href="../api/io/micronaut/coherence/annotation/Starting.html">@Starting</a> annotation</p>
</li>
<li>
<p>Started - a <code>Coherence</code> instance has started, use the <a href="../api/io/micronaut/coherence/annotation/Started.html">@Started</a> annotation</p>
</li>
<li>
<p>Stopping - a <code>Coherence</code> instance is about to stop, use the <a href="../api/io/micronaut/coherence/annotation/Stopping.html">@Stopping</a> annotation</p>
</li>
<li>
<p>Stopped - a <code>Coherence</code> instance has stopped, use the <a href="../api/io/micronaut/coherence/annotation/Stopped.html">@Stopped</a> annotation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the method below will only receive <code>Started</code> and <code>Stopped</code> events.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@Started @Stopped SessionLifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_receive_sessionlifecycleevents_for_a_specific_session_instance">Receive SessionLifecycleEvents for a Specific Session Instance</h3>
<div class="paragraph">
<p>Each <code>Session</code> instance in an application has a name. The observer method can be annotated to only receive events associated with a specific <code>Session</code> instance by using the <a href="../api/io/micronaut/coherence/annotation/Name.html">@Name</a> annotation.</p>
</div>
<div class="paragraph">
<p>For example, the method below will only receive events for the <code>Session</code> instance named <code>customers</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@Name("customers") SessionLifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The method in this example will receive events for the default <code>Coherence</code> instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@Name(Coherence.DEFAULT_NAME) SessionLifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>

<h2 id="lifecycleEvent"><a class="anchor" href="#lifecycleEvent"></a>7.2.3 ConfigurableCacheFactory Lifecycle Events</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/coherenceEvents/lifecycleEvent.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/application/LifecycleEvent.html">LifecycleEvent</a> are emitted to indicate the lifecycle of a <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/ConfigurableCacheFactory.html">ConfigurableCacheFactory</a> instance.</p>
</div>
<div class="paragraph">
<p>To subscribe to <code>LifecycleEvent</code> simply create a Micronaut bean with a listener method annotated with <a href="../api/io/micronaut/coherence/annotation/CoherenceEventListener.html">@CoherenceEventListener</a>.
The method should have a single parameter of type <code>LifecycleEvent</code>.</p>
</div>
<div class="paragraph">
<p><code>LifecycleEvent</code> are emitted by <code>ConfigurableCacheFactory</code> instances and will only be received in the same JVM, which could be a cluster member or a client.</p>
</div>
<div class="paragraph">
<p>For example, the <code>onEvent</code> method below will receive lifecycle events for all <code>ConfigurableCacheFactory</code> instances in the current application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(LifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_receive_specific_lifecycleevent_types">Receive Specific LifecycleEvent Types</h3>
<div class="paragraph">
<p>There are four different types of <code>LifecycleEvent</code>.
By adding the corresponding annotation to the method parameter the method will only receive the specified events.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Activating - a <code>ConfigurableCacheFactory</code> instance is about to be activated, use the <a href="../api/io/micronaut/coherence/annotation/Activating.html">@Activating</a> annotation</p>
</li>
<li>
<p>Activated - a <code>ConfigurableCacheFactory</code> instance has been activated, use the <a href="../api/io/micronaut/coherence/annotation/Activated.html">@Activated</a> annotation</p>
</li>
<li>
<p>Disposing - a <code>ConfigurableCacheFactory</code> instance is about to be disposed, use the <a href="../api/io/micronaut/coherence/annotation/Disposing.html">@Disposing</a> annotation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the method below will only receive <code>Activated</code> and <code>Disposing</code> events.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@Activated @Disposing LifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>

<h2 id="cacheLifecycleEvent"><a class="anchor" href="#cacheLifecycleEvent"></a>7.2.4 Cache Lifecycle Events</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/coherenceEvents/cacheLifecycleEvent.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/cache/CacheLifecycleEvent.html">CacheLifecycleEvent</a> are emitted to indicate the lifecycle of a cache instance.</p>
</div>
<div class="paragraph">
<p>To subscribe to <code>CacheLifecycleEvent</code> simply create a Micronaut bean with a listener method annotated with <a href="../api/io/micronaut/coherence/annotation/CoherenceEventListener.html">@CoherenceEventListener</a>.
The method should have a single parameter of type <code>CacheLifecycleEvent</code>.</p>
</div>
<div class="paragraph">
<p>For example, the <code>onEvent</code> method below will receive lifecycle events for all caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(CacheLifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_receive_specific_cachelifecycleevent_types">Receive Specific CacheLifecycleEvent Types</h3>
<div class="paragraph">
<p>There are three types of `CacheLifecycleEvent:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Created - a cache instance has been created, use the <a href="../api/io/micronaut/coherence/annotation/Created.html">@Created</a> annotation</p>
</li>
<li>
<p>Truncated - a cache instance has been truncated (all data was removed), use the <a href="../api/io/micronaut/coherence/annotation/Truncated.html">@Truncated</a> annotation</p>
</li>
<li>
<p>Destroyed - a cache has been destroyed (destroy is a cluster wide operation, so the cache is destroyed on all members of the cluster and clients) use the <a href="../api/io/micronaut/coherence/annotation/Destroyed.html">@Destroyed</a> annotation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the method below will only receive <code>Created</code> and <code>Destroyed</code> events for all caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@Created @Destroyed CacheLifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_receive_cachelifecycleevents_for_a_specific_namedmap_or_namedcache">Receive CacheLifecycleEvents for a Specific NamedMap or NamedCache</h3>
<div class="paragraph">
<p>To only receive events for a specific <code>NamedMap</code> annotate the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/MapName.html">@MapName</a> annotation.
To only receive events for a specific <code>NamedCache</code> annotate the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/CacheName.html">@CacheName</a> annotation.</p>
</div>
<div class="paragraph">
<p>The <code>@MapName</code> and <code>@CacheName</code> annotations are actually interchangeable so use whichever reads better for your application code, i.e. if your code is dealing with <code>NamedMap</code> used <code>@MapName</code>. At the storage level, where the events are generated a <code>NamedMap</code> and <code>NamedCache</code> are the same.</p>
</div>
<div class="paragraph">
<p>The method below will only receive events for the map named <code>orders</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@MapName("orders") CacheLifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_receive_cachelifecycleevents_from_a_specific_cache_service">Receive CacheLifecycleEvents from a Specific Cache Service</h3>
<div class="paragraph">
<p>Caches are owned by a Cache Service, it is possible to restrict events received by a method to only those related to caches owned by a specific service by annotating the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/ServiceName.html">@ServiceName</a> annotation.</p>
</div>
<div class="paragraph">
<p>The method below will only receive events for the caches owned by the service named <code>StorageService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@ServiceName("StorageService") CacheLifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_receive_cachelifecycleevents_from_a_specific_session">Receive CacheLifecycleEvents from a Specific Session</h3>
<div class="paragraph">
<p>A typical use case is to obtain <code>NamedCache</code> and <code>NamedMap</code> instances from a <code>Session</code>. It is possible to restrict events received by a method to only those related to caches owned by a specific <code>Session</code> by annotating the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/SessionName.html">@SessionName</a> annotation.</p>
</div>
<div class="paragraph">
<p>The method below will only receive events for the caches owned by the <code>Session</code> named <code>BackEnd</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@SessionName("BackEnd") CacheLifecycleEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>

<h2 id="entryEvent"><a class="anchor" href="#entryEvent"></a>7.2.5 Entry Events</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/coherenceEvents/entryEvent.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>An <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/cache/EntryEvent.html">EntryEvent</a> is emitted when a <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/util/EntryProcessor.html">EntryProcessor</a> is invoked on a cache. These events are only emitted on the storage enabled member that is the primary owner of the entry that the <code>EntryProcessor</code> is invoked on.</p>
</div>
<div class="paragraph">
<p>To subscribe to <code>EntryEvent</code> simply create a Micronaut bean with a listener method annotated with <a href="../api/io/micronaut/coherence/annotation/CoherenceEventListener.html">@CoherenceEventListener</a>.
The method should have a single parameter of type <code>EntryEvent</code>.</p>
</div>
<div class="paragraph">
<p>For example, the <code>onEvent</code> method below will receive entry events for all caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(EntryEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_receive_specific_entryevent_types">Receive Specific EntryEvent Types</h3>
<div class="paragraph">
<p>There are a number of different <code>EntryEvent</code> types.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inserting - an entry is being inserted into a cache, use the <a href="../api/io/micronaut/coherence/annotation/Inserting.html">@Inserting</a> annotation</p>
</li>
<li>
<p>Inserted - an entry has been inserted into a cache, use the <a href="../api/io/micronaut/coherence/annotation/Inserted.html">@Inserted</a> annotation</p>
</li>
<li>
<p>Updating - an entry is being updated in a cache, use the <a href="../api/io/micronaut/coherence/annotation/Updating.html">@Updating</a> annotation</p>
</li>
<li>
<p>Updated - an entry has been updated in a cache, use the <a href="../api/io/micronaut/coherence/annotation/Updated.html">@Updated</a> annotation</p>
</li>
<li>
<p>Deleting - an entry is being deleted from a cache, use the <a href="../api/io/micronaut/coherence/annotation/Deleting.html">@Deleting</a> annotation</p>
</li>
<li>
<p>Deleted - an entry has been deleted from a cache, use the <a href="../api/io/micronaut/coherence/annotation/Deleted.html">@Deleted</a> annotation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To restrict the <code>EntryEvent</code> types received by a method apply one or more of the annotations above to the method parameter. For example, the method below will receive <code>Inserted</code> and <code>Deleted</code> events.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@Inserted @Deleted EntryEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The event types fall into two categories, pre-events (those name *ing) and post-events, those named *ed). Pre-events are emitted synchronously before the entry is mutated. Post-events are emitted asynchronously after the entry has been mutated.</p>
</div>
<div class="paragraph">
<p>As pre-events are synchronous the listener method should not take a long time to execute as it is blocking the cache mutation and could obviously be a performance impact. It is also important that developers understand Coherence reentrancy as the pre-events are executing on the Cache Service thread so cannot call into caches owned by the same service.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_receive_entryevents_for_a_specific_namedmap_or_namedcache">Receive EntryEvents for a Specific NamedMap or NamedCache</h3>
<div class="paragraph">
<p>To only receive events for a specific <code>NamedMap</code> annotate the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/MapName.html">@MapName</a> annotation.
To only receive events for a specific <code>NamedCache</code> annotate the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/CacheName.html">@CacheName</a> annotation.</p>
</div>
<div class="paragraph">
<p>The <code>@MapName</code> and <code>@CacheName</code> annotations are actually interchangeable so use whichever reads better for your application code, i.e. if your code is dealing with <code>NamedMap</code> used <code>@MapName</code>. At the storage level, where the events are generated a <code>NamedMap</code> and <code>NamedCache</code> are the same.</p>
</div>
<div class="paragraph">
<p>The method below will only receive events for the map named <code>orders</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@MapName("orders") EntryEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_receive_entryevents_from_a_specific_cache_service">Receive EntryEvents from a Specific Cache Service</h3>
<div class="paragraph">
<p>Caches are owned by a Cache Service, it is possible to restrict events received by a method to only those related to caches owned by a specific service by annotating the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/ServiceName.html">@ServiceName</a> annotation.</p>
</div>
<div class="paragraph">
<p>The method below will only receive events for the caches owned by the service named <code>StorageService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@ServiceName("StorageService") EntryEvents event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_receive_entryevents_from_a_specific_session">Receive EntryEvents from a Specific Session</h3>
<div class="paragraph">
<p>A typical use case is to obtain <code>NamedCache</code> and <code>NamedMap</code> instances from a <code>Session</code>. It is possible to restrict events received by a method to only those related to caches owned by a specific <code>Session</code> by annotating the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/SessionName.html">@SessionName</a> annotation.</p>
</div>
<div class="paragraph">
<p>The method below will only receive events for the caches owned by the <code>Session</code> named <code>BackEnd</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@SessionName("BackEnd") EntryEvents event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>

<h2 id="entryProcessorEvent"><a class="anchor" href="#entryProcessorEvent"></a>7.2.6 EntryProcessor Events</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/coherenceEvents/entryProcessorEvent.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>An <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/cache/EntryProcessorEvent.html">EntryProcessorEvent</a> is emitted when a mutation occurs on an entry in a cache. These events are only emitted on the storage enabled member that is the primary owner of the entry.</p>
</div>
<div class="paragraph">
<p>To subscribe to <code>EntryProcessorEvent</code> simply create a Micronaut bean with a listener method annotated with <a href="../api/io/micronaut/coherence/annotation/CoherenceEventListener.html">@CoherenceEventListener</a>.
The method should have a single parameter of type <code>EntryProcessorEvent</code>.</p>
</div>
<div class="paragraph">
<p>For example, the <code>onEvent</code> method below will receive entry events for all caches.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(EntryProcessorEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_receive_specific_entryprocessorevent_types">Receive Specific EntryProcessorEvent Types</h3>
<div class="paragraph">
<p>There are a number of different <code>EntryProcessorEvent</code> types.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Executing - an <code>EntryProcessor</code> is being invoked on a cache, use the <a href="../api/io/micronaut/coherence/annotation/Executing.html">@Executing</a> annotation</p>
</li>
<li>
<p>Executed - an <code>EntryProcessor</code> has been invoked on a cache, use the <a href="../api/io/micronaut/coherence/annotation/Executed.html">@Executed</a> annotation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To restrict the <code>EntryProcessorEvent</code> types received by a method apply one or more of the annotations above to the method parameter. For example, the method below will receive <code>Executed</code> events.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@Executed EntryProcessorEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The event types fall into two categories, pre-event ('Executing') and post-event (<code>Executed</code>). Pre-events are emitted synchronously before the <code>EntryProcessor</code> is invoked. Post-events are emitted asynchronously after the <code>EntryProcessor</code> has been invoked.</p>
</div>
<div class="paragraph">
<p>As pre-events are synchronous the listener method should not take a long time to execute as it is blocking the <code>EntryProcessor</code> invocation and could obviously be a performance impact. It is also important that developers understand Coherence reentrancy as the pre-events are executing on the Cache Service thread so cannot call into caches owned by the same service.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_receive_entryprocessorevents_for_a_specific_namedmap_or_namedcache">Receive EntryProcessorEvents for a Specific NamedMap or NamedCache</h3>
<div class="paragraph">
<p>To only receive events for a specific <code>NamedMap</code> annotate the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/MapName.html">@MapName</a> annotation.
To only receive events for a specific <code>NamedCache</code> annotate the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/CacheName.html">@CacheName</a> annotation.</p>
</div>
<div class="paragraph">
<p>The <code>@MapName</code> and <code>@CacheName</code> annotations are actually interchangeable so use whichever reads better for your application code, i.e. if your code is dealing with <code>NamedMap</code> used <code>@MapName</code>. At the storage level, where the events are generated a <code>NamedMap</code> and <code>NamedCache</code> are the same.</p>
</div>
<div class="paragraph">
<p>The method below will only receive events for the map named <code>orders</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@MapName("orders") EntryProcessorEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_receive_entryprocessorevents_from_a_specific_cache_service">Receive EntryProcessorEvents from a Specific Cache Service</h3>
<div class="paragraph">
<p>Caches are owned by a Cache Service, it is possible to restrict events received by a method to only those related to caches owned by a specific service by annotating the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/ServiceName.html">@ServiceName</a> annotation.</p>
</div>
<div class="paragraph">
<p>The method below will only receive events for the caches owned by the service named <code>StorageService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@ServiceName("StorageService") EntryProcessorEvents event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_receive_entryprocessorevents_from_a_specific_session">Receive EntryProcessorEvents from a Specific Session</h3>
<div class="paragraph">
<p>A typical use case is to obtain <code>NamedCache</code> and <code>NamedMap</code> instances from a <code>Session</code>. It is possible to restrict events received by a method to only those related to caches owned by a specific <code>Session</code> by annotating the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/SessionName.html">@SessionName</a> annotation.</p>
</div>
<div class="paragraph">
<p>The method below will only receive events for the caches owned by the <code>Session</code> named <code>BackEnd</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@SessionName("BackEnd") EntryProcessorEvents event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>

<h2 id="transactionEvent"><a class="anchor" href="#transactionEvent"></a>7.2.7 Partition Level Transaction Events</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/coherenceEvents/transactionEvent.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>A <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/TransactionEvent.html">TransactionEvent</a> is emitted in relation to all mutations in a single partition in response to executing a single request.
These are commonly referred to as partition level transactions.
For example, an <code>EntryProcessor</code> that mutates more than one entry (which could be in multiple caches) as part of a single invocation will cause a partition level transaction to occur encompassing all of those cache entries.</p>
</div>
<div class="paragraph">
<p>Transaction events are emitted by storage enabled cache services, they will only e received on the same member that the partition level transaction occurred.</p>
</div>
<div class="paragraph">
<p>To subscribe to <code>TransactionEvent</code> simply create a Micronaut bean with a listener method annotated with <a href="../api/io/micronaut/coherence/annotation/CoherenceEventListener.html">@CoherenceEventListener</a>.
The method should have a single parameter of type <code>TransactionEvent</code>.</p>
</div>
<div class="paragraph">
<p>For example, the <code>onEvent</code> method below will receive all transaction events emitted by storage enabled cache services in the same JVM.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(TransactionEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_receive_specific_transactionevent_types">Receive Specific TransactionEvent Types</h3>
<div class="paragraph">
<p>There are a number of different <code>TransactionEvent</code> types.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Committing - A COMMITTING event is raised prior to any updates to the underlying backing map.
This event will contain all modified entries which may span multiple backing maps. Use the <a href="../api/io/micronaut/coherence/annotation/Inserting.html">@Committing</a> annotation</p>
</li>
<li>
<p>Committed - A COMMITTED event is raised after any mutations have been committed to the underlying backing maps.
This event will contain all modified entries which may span multiple backing maps.
Use the <a href="../api/io/micronaut/coherence/annotation/Inserted.html">@Committed</a> annotation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To restrict the <code>TransactionEvent</code> types received by a method apply one or more of the annotations above to the method parameter. For example, the method below will receive <code>Committed</code> events.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@Committed TransactionEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_receive_transactionevent_from_a_specific_cache_service">Receive TransactionEvent from a Specific Cache Service</h3>
<div class="paragraph">
<p>Caches are owned by a Cache Service, it is possible to restrict events received by a method to only those related to caches owned by a specific service by annotating the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/ServiceName.html">@ServiceName</a> annotation.</p>
</div>
<div class="paragraph">
<p>The method below will only receive events for the caches owned by the service named <code>StorageService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@ServiceName("StorageService") TransactionEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>

<h2 id="transferEvent"><a class="anchor" href="#transferEvent"></a>7.2.8 Partition Transfer Events</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/coherenceEvents/transferEvent.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>A <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/TransferEvent.html">TransferEvent</a> captures information concerning the transfer of a partition for a storage enabled member. Transfer events are raised against the set of <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/util/BinaryEntry.html">BinaryEntry</a> instances that are being transferred.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
TransferEvents are dispatched to interceptors while holding a lock on the partition being transferred, blocking any operations for the partition. Event observer methods should therefore execute as quickly as possible of hand-off execution to another thread.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To subscribe to <code>TransferEvent</code> simply create a Micronaut bean with a listener method annotated with <a href="../api/io/micronaut/coherence/annotation/CoherenceEventListener.html">@CoherenceEventListener</a>.
The method should have a single parameter of type <code>TransferEvent</code>.</p>
</div>
<div class="paragraph">
<p>For example, the <code>onEvent</code> method below will receive all transaction events emitted by storage enabled cache services in the same JVM.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(TransferEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_receive_specific_transferevent_types">Receive Specific TransferEvent Types</h3>
<div class="paragraph">
<p>There are a number of different <code>TransferEvent</code> types.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Arrived - This <code>TransferEvent</code> is dispatched when a set of <code>BinaryEntry</code> instances have been transferred to the <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/TransferEvent.html#getLocalMember()">local member</a> or restored from backup.The reason for the event (primary transfer from another member or restore from backup) can be derived as follows:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">TransferEvent event;
boolean restored = event.getRemoteMember() == event.getLocalMember();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the <a href="../api/io/micronaut/coherence/annotation/Arrived.html">@Arrived</a> annotation to restrict the received events to arrived type.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Assigned -  This <code>TransferEvent</code> is dispatched when a partition has been assigned to the <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/TransferEvent.html#getLocalMember()">local member</a>. This event will only be emitted by the ownership senior during the initial partition assignment.
Use the <a href="../api/io/micronaut/coherence/annotation/Assigned.html">@Assigned</a> annotation to restrict received events.</p>
</li>
<li>
<p>Departing - This <code>TransferEvent</code> is dispatched when a set of <code>BinaryEntry</code> are being transferred from the <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/TransferEvent.html#getLocalMember()">local member</a>. This event is followed by either a <code>Departed</code> or <code>Rollback</code> event to indicate the success or failure of the transfer.
Use the <a href="../api/io/micronaut/coherence/annotation/Departing.html">@Departing</a> annotation to restrict received events.</p>
</li>
<li>
<p>Departed - This <code>TransferEvent</code> is dispatched when a partition has been successfully transferred from the <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/TransferEvent.html#getLocalMember()">local member</a>. To derive the <code>BinaryEntry</code> instances associated with the transfer, consumers should subscribe to the <code>Departing</code> event that would precede this event.
Use the <a href="../api/io/micronaut/coherence/annotation/Departed.html">@Departed</a> annotation to restrict received events.</p>
</li>
<li>
<p>Lost - This <code>TransferEvent</code> is dispatched when a partition has been orphaned (data loss <em>may</em> have occurred), and the ownership is assumed by the <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/TransferEvent.html#getLocalMember()">local member</a>. This event is only be emitted by the ownership senior.
Use the <a href="../api/io/micronaut/coherence/annotation/Lost.html">@Lost</a> annotation to restrict received events.</p>
</li>
<li>
<p>Recovered - This <code>TransferEvent</code> is dispatched when a set of <code>BinaryEntry</code> instances have been recovered from a persistent storage by the <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/TransferEvent.html#getLocalMember()">local member</a>.
Use the <a href="../api/io/micronaut/coherence/annotation/Recovered.html">@Recovered</a> annotation to restrict received events.</p>
</li>
<li>
<p>Rollback - This <code>TransferEvent</code> is dispatched when partition transfer has failed and was therefore rolled back. To derive the <code>BinaryEntry</code> instances associated with the failed transfer, consumers should subscribe to the <code>Departing</code> event that would precede this event.
Use the <a href="../api/io/micronaut/coherence/annotation/Rollback.html">@Rollback</a> annotation to restrict received events.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To restrict the <code>TransferEvent</code> types received by a method apply one or more of the annotations above to the method parameter. For example, the method below will receive <code>Lost</code> events.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@Lost TransferEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Multiple type annotations may be used to receive multiple types of <code>TransferEvent</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_receive_transferevent_from_a_specific_cache_service">Receive TransferEvent from a Specific Cache Service</h3>
<div class="paragraph">
<p>Caches are owned by a Cache Service, it is possible to restrict events received by a method to only those related to caches owned by a specific service by annotating the method parameter with the
<a href="../api/io/micronaut/coherence/annotation/ServiceName.html">@ServiceName</a> annotation.</p>
</div>
<div class="paragraph">
<p>The method below will only receive events for the caches owned by the service named <code>StorageService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(@ServiceName("StorageService") TransferEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>
</div>

<h2 id="unsolicitedCommitEvent"><a class="anchor" href="#unsolicitedCommitEvent"></a>7.2.9 Unsolicited Commit Events</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/events/coherenceEvents/unsolicitedCommitEvent.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>An <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/events/partition/UnsolicitedCommitEvent.html">UnsolicitedCommitEvent</a> captures changes pertaining to all observed mutations performed against caches that were not directly caused (solicited) by the partitioned service. These events may be due to changes made internally by the backing map, such as eviction, or referrers of the backing map causing changes.</p>
</div>
<div class="paragraph">
<p>Unsolicited commit events are emitted by storage enabled cache services, they will only e received on the same member.</p>
</div>
<div class="paragraph">
<p>To subscribe to <code>UnsolicitedCommitEvent</code> simply create a Micronaut bean with a listener method annotated with <a href="../api/io/micronaut/coherence/annotation/CoherenceEventListener.html">@CoherenceEventListener</a>.
The method should have a single parameter of type <code>UnsolicitedCommitEvent</code>.</p>
</div>
<div class="paragraph">
<p>For example, the <code>onEvent</code> method below will receive all Unsolicited commit events emitted by storage enabled cache services in the same JVM.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceEventListener
public void onEvent(UnsolicitedCommitEvent event) {
    // ToDo: process the event
}</code></pre>
</div>
</div>

<h1 id="messagingWithTopics"><a class="anchor" href="#messagingWithTopics"></a>8 Messaging with Coherence Topics</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/messagingWithTopics.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Micronaut Coherence integration provides support for message driven applications by integrating <a href="https://docs.micronaut.io/latest/guide/index.html#messaging">Micronaut Messaging</a> and Coherence topics.</p>
</div>
<div class="paragraph">
<p>A Coherence <a href="https://coherence.community/latest/21.12/api/java/index.htmlcom/tangosol/net/topic/NamedTopic.html">NamedTopic</a> is analogous to a queue or pub/sub topic, depending on the configuration and application code. Messages published to the topic are stored in Coherence caches, so topics are scalable and performant.</p>
</div>
<div class="paragraph">
<p>A typical stand-alone Coherence application would create a <code>NamedTopic</code> along with <code>Publisher</code> or <code>Subscriber</code> instances to publish to or subscribe to topics. Injection of topics into Micronaut applications is already covered in <a href="#injectNamedTopic">Injecting NamedTopics</a>. With Micronaut messaging this becomes much simpler.</p>
</div>
<div class="paragraph">
<p>With Micronaut Coherence Messaging publishers and subscribers beans are created by writing suitably annotated interfaces.</p>
</div>

<h2 id="publishers"><a class="anchor" href="#publishers"></a>8.1 Define Publishers - @CoherencePublisher</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/messagingWithTopics/publishers.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To create a topic Publisher that sends messages you can simply define an interface that is annotated with <a href="../api/io/micronaut/coherence/annotation/CoherencePublisher.html"><code>@CoherencePublisher</code></a>.</p>
</div>
<div class="paragraph">
<p>For example the following is a trivial <code>@CoherencePublisher</code> interface:</p>
</div>
<div class="listingblock">
<div class="title">ProductClient.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.micronaut.coherence.annotation.CoherencePublisher;
import io.micronaut.coherence.annotation.Topic;

@CoherencePublisher  <i class="conum" data-value="1"></i><b>(1)</b>
public interface ProductClient {

    @Topic("my-products") <i class="conum" data-value="2"></i><b>(2)</b>
    void sendProduct(String message); <i class="conum" data-value="3"></i><b>(3)</b>

    void sendProduct(@Topic String topic, String message); <i class="conum" data-value="4"></i><b>(4)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@CoherencePublisher</code> annotation is used to designate this interface as a message publisher.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>@Topic</code> annotation indicates which topics the message should be published to</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The method defines a single parameter, which is the message value. In this case the values being published are String instances, but they could be any type that can be serialized by Coherence.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>It is also possible for the topic to be dynamic by making it a method argument annotated with .</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>At compile time Micronaut will produce an implementation of the above interface. You can retrieve an instance of <code>ProductClient</code> either by looking up the bean from the <code>ApplicationContext</code> or by injecting the bean with <code>@Inject</code>:</p>
</div>
<div class="listingblock">
<div class="title">Using ProductClient</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ProductClient client = applicationContext.getBean(ProductClient.class);
client.sendProduct("Blue Trainers");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that since the sendProduct method returns void this means the method will send the message and block until the message has been sent. You can return a <code>Future</code> to support non-blocking message delivery.</p>
</div>
<div class="sect2">
<h3 id="_reactive_and_non_blocking_method_definitions">Reactive and Non-Blocking Method Definitions</h3>
<div class="paragraph">
<p>The <code>@CoherencePublisher</code> annotation supports the definition of reactive return types (such as <a href="http://reactivex.io/RxJava/2.x/javadoc/io/reactivex/Flowable.html">Flowable</a> or Reactor <code>Flux</code>) as well as Futures.</p>
</div>
<div class="paragraph">
<p>The following sections cover possible method signatures and behaviour:</p>
</div>
<div class="sect3">
<h4 id="_single_value_and_return_type">Single Value and Return Type</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Single&lt;Book&gt; sendBook(Single&lt;Book&gt; book);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The implementation will return a <a href="http://reactivex.io/RxJava/2.x/javadoc/io/reactivex/Single.html">Single</a> that when subscribed to will subscribe to the passed <a href="http://reactivex.io/RxJava/2.x/javadoc/io/reactivex/Single.html">Single</a> and send the emitted item as a message emitting the item again if successful or an error otherwise.</p>
</div>
</div>
<div class="sect3">
<h4 id="_flowable_value_and_return_type">Flowable Value and Return Type</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Flowable&lt;Book&gt; sendBooks(Flowable&lt;Book&gt; book);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The implementation will return a <a href="http://reactivex.io/RxJava/2.x/javadoc/io/reactivex/Flowable.html">Flowable</a> that when subscribed to will subscribe to the passed <a href="http://reactivex.io/RxJava/2.x/javadoc/io/reactivex/Flowable.html">Flowable</a> and for each emitted item will send a message emitting the item again if successful or an error otherwise.</p>
</div>
</div>
<div class="sect3">
<h4 id="_reactor_flux_value_and_return_type">Reactor Flux Value and Return Type</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Flux&lt;RecordMetadata&gt; sendBooks(Flux&lt;Book&gt; book);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The implementation will return a Reactor <code>Flux</code> that when subscribed to will subscribe to the passed <code>Flux</code> and for each emitted item will send a message emitting the resulting message if successful or an error otherwise.</p>
</div>
</div>
</div>

<h2 id="subscribers"><a class="anchor" href="#subscribers"></a>8.2 Define Subscribers - @CoherenceTopicListener</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/messagingWithTopics/subscribers.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To listen to Coherence topic messages you can use the <a href="../api/io/micronaut/coherence/annotation/CoherenceTopicListener.html">@CoherenceTopicListener</a> annotation to define a message listener.</p>
</div>
<div class="paragraph">
<p>The following example will listen for messages published by the <code>ProductClient</code> in the previous section:</p>
</div>
<div class="listingblock">
<div class="title">ProductListener.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.micronaut.coherence.annotation.CoherenceTopicListener;
import io.micronaut.coherence.annotation.Topic;

@CoherenceTopicListener   <i class="conum" data-value="1"></i><b>(1)</b>
public class ProductListener {

    @Topic("my-products")   <i class="conum" data-value="2"></i><b>(2)</b>
    public void receive(String product) { <i class="conum" data-value="3"></i><b>(3)</b>
        System.out.println("Got Product - " + product);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <a href="../api/io/micronaut/coherence/annotation/CoherenceTopicListener.html">@CoherenceTopicListener</a> annotation to indicate that this bean is a Coherence topic listener.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <a href="../api/io/micronaut/coherence/annotation/Topic.html">@Topic</a> annotation is again used to indicate which topic to subscribe to.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>receive</code> method defines single arguments that will receive the message value, in this case the message is of type <code>String</code>.</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_method_parameter_bindings">Method Parameter Bindings</h3>
<div class="paragraph">
<p>When using a Coherence topic <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/topic/Subscriber.html">Subscriber</a> directly in application code, the <code>receive</code> method returns an <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/topic/Subscriber.Element.html">Element</a>, which contains the message value and metadata. The annotated subscriber method can take various parameter types that will bind to the element itself, the message, or the metadata fields of the element.</p>
</div>
<div class="paragraph">
<p>For example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceTopicListener
@Topic("my-products")
public void receive(Element&lt;Product&gt; product) {
    // ... process message ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The method above will be passed the <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/net/topic/Subscriber.Element.html">Element</a> received from the topic. By receiving the element, the method has access to the message value and all the metadata stored with the message.</p>
</div>
<div class="paragraph">
<p>Alternatively, just select parts of the metadata can be passed as parameters.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter Name</th>
<th class="tableblock halign-left valign-top">Parameter Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>channel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code> or <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The channel in the topic that the message was published to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>position</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.tangosol.net.topic.Position</code>,</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The opaque representation of the message&#8217;s position in the channel in the topic.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timestamp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.time.Instant</code>, <code>long</code> or <code>Long</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time that the message was received on the server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>any</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.tangosol.net.topic.Subscriber</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The underlying subscriber the message was received from</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>any</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.tangosol.util.Binary</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The message value in serialized form. Message values are lazily deserialized in the received element, so if a handler method just needs the serialized form of the message it can be slightly more efficient to take a <code>Binary</code> parameter.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some parameters in the table above have fixed parameter names, i.e., <code>channel</code>, <code>position</code> and <code>timestamp</code>. When using these parameters in annotated message handler methods both the parameter name and type must match those in the table above. This is to avoid confusion where the message value type is the same as one of the metadata types where the binding logic would not know what to bind to which parameter. For example, in the unlikely scenario where the message value was just an <code>int</code> and the annotated method was something like <code>public void processMessage(int c, int v)</code> where <code>c</code> is supposed to represent the channel and <code>v</code> the value, the binder would not be able to work this out.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_committing_messages">Committing Messages</h3>
<div class="paragraph">
<p>An important part of Coherence topic subscribers is committing messages to notify the server that they have been processed and guaranteeing at least once delivery. When using Micronaut Coherence messaging every message will be committed after the handler method has successfully processed the message. This behaviour can be controlled by adding a commit strategy to the <a href="../api/io/micronaut/coherence/annotation/CoherenceTopicListener.html">@CoherenceTopicListener</a> annotation.</p>
</div>
<div class="sect3">
<h4 id="_default_commit_behaviour">Default Commit Behaviour</h4>
<div class="paragraph">
<p>If no <code>commitStrategy</code> field has been provided to the <code>@CoherenceTopicListener</code> annotation the default behaviour is to synchronously call <code>Element.commit()</code> for every message received.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceTopicListener
@Topic("my-products")
public void receive(Element&lt;Product&gt; product) {
    // ... process message ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>No <code>commitStrategy</code> field has been supplied to the <code>@CoherenceTopicListener</code> annotation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_setting_commit_strategy">Setting Commit Strategy</h4>
<div class="paragraph">
<p>The <a href="../api/io/micronaut/coherence/annotation/CoherenceTopicListener.html">@CoherenceTopicListener</a> <code>commitStrategy</code> field is an enumeration of type <a href="../api/io/micronaut/coherence/annotation/CommitStrategy.html">CommitStrategy</a> with three values, <code>SYNC</code>, <code>ASYNC</code> and <code>MANUAL</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CommitStrategy.SYNC - This strategy is the default, and will synchronously commit every message upon successful completion of the handler method, by calling <code>Element.commit()</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceTopicListener(commitStrategy = CommitStrategy.SYNC)
@Topic("my-products")
public void receive(Product product) {
    // ... process message ...
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>CommitStrategy.ASYNC - This strategy will asynchronously commit every message upon successful completion of the handler method, by calling <code>Element.commitAsync()</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceTopicListener(commitStrategy = CommitStrategy.ASYNC)
@Topic("my-products")
public void receive(Product product) {
    // ... process message ...
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>CommitStrategy.MANUAL - This strategy will not automatically commit messages, all handling of commits must be done as part of the handler method or by some external process.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@CoherenceTopicListener(commitStrategy = CommitStrategy.MANUAL)
@Topic("my-products")
public void receive(Element&lt;Product&gt; product) {
    // ... process message ...

    // manually commit the element
    element.commit();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above a <code>MANUAL</code> commit strategy has used. The element will be committed by the application code at the end of the handler method. To be able to manually commit a message the method must take the <code>Element</code> as a parameter so that application code can access the commit methods.</p>
</div>
</div>
</div>

<h2 id="forwarding"><a class="anchor" href="#forwarding"></a>8.2.1 Forwarding Messages with @SendTo</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/messagingWithTopics/subscribers/forwarding.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>On any @<a href="../api/io/micronaut/coherence/annotation/CoherenceTopicListener.html">@CoherenceTopicListener</a> method that returns a value, you can use the @SendTo annotation to forward the return value to the topic or topics specified by the @SendTo annotation.</p>
</div>
<div class="paragraph">
<p>The key of the original ConsumerRecord will be used as the key when forwarding the message.</p>
</div>
<div class="listingblock">
<div class="title">filename.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.micronaut.coherence.annotation.*;
import io.micronaut.messaging.annotation.SendTo;

@CoherenceTopicListener
public class ProductListener {

    @Topic("awesome-products")      <i class="conum" data-value="1"></i><b>(1)</b>
    @SendTo("product-quantities")   <i class="conum" data-value="2"></i><b>(2)</b>
    public int receive(Product product) {
        System.out.println("Got Product - " + product.getName() + " by " + product.getBrand());
        return product.getQuantity(); <i class="conum" data-value="3"></i><b>(3)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The topic subscribed to is <code>awesome-products</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The topic to send the result to is <code>product-quantities</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The return value is used to indicate the value to forward</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also do the same using Reactive programming:</p>
</div>
<div class="listingblock">
<div class="title">filename.java</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.micronaut.coherence.annotation.*;
import io.micronaut.messaging.annotation.SendTo;
import io.reactivex.Single;
import io.reactivex.functions.Function;

@CoherenceTopicListener
public class ProductListener {

    @Topic("awesome-products")       <i class="conum" data-value="1"></i><b>(1)</b>
    @SendTo("product-quantities")    <i class="conum" data-value="2"></i><b>(2)</b>
    public Single&lt;Integer&gt; receiveProduct(Single&lt;Product&gt; productSingle) {
        return productSingle.map(product -&gt; {
            System.out.println("Got Product - " + product.getName() + " by " + product.getBrand());
            return product.getQuantity();  <i class="conum" data-value="3"></i><b>(3)</b>
        });
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The topic subscribed to is <code>awesome-products</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The topic to send the result to is <code>product-quantities</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The return is mapped from the single to the value of the quantity</td>
</tr>
</table>
</div>

<h1 id="filterBinding"><a class="anchor" href="#filterBinding"></a>9 Filter Binding Annotations</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/filterBinding.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Filter binding annotations are normal annotations that are themselves annotated with the <a href="../api/io/micronaut/coherence/annotation/FilterBinding.html">@FilterBinding</a> meta-annotation.
A filter binding annotation represents a Coherence <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/util/Filter.html">Filter</a> and is used to specify a <code>Filter</code> in certain injection points, for example a View (CQC), <code>NamedTopic</code> <code>Subscriber</code> beans, event listeners, etc.</p>
</div>
<div class="paragraph">
<p>There are three parts to using a filter binding:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The filter binding annotation</p>
</li>
<li>
<p>An implementation of a <a href="../api/io/micronaut/coherence/FilterFactory.html">FilterFactory</a> that is annotated with the filter binding annotation. This is a factory that produces the required <code>Filter</code>.</p>
</li>
<li>
<p>Injection points annotated with the filter binding annotation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example; assume there is a Coherence <code>NamedMap</code> with the name <code>people</code> that contains <code>Person</code> instances for the value.
Among the various properties on the <code>Person</code> class is a property called <code>gender</code> and property called <code>age</code>.
Now assume we want to inject a view that only shows adult males, we would need a <code>Filter</code> that has a condition like `gender == "male" &amp;&amp; age &gt; 18".</p>
</div>
<div class="sect2">
<h3 id="_create_the_filter_binding_annotation">Create the filter binding annotation</h3>
<div class="paragraph">
<p>First create a simple annotation, it could be called something like <code>AdultMales</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@FilterBinding                         <i class="conum" data-value="1"></i><b>(1)</b>
@Documented
@Retention(RetentionPolicy.RUNTIME)
public @interface AdultMales {         <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The annotation class is annotated with <code>@FilterBinding</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The annotation name is <code>AdultMales</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this case the annotation does not need any other attributes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_create_the_filterfactory">Create the <code>FilterFactory</code></h3>
<div class="paragraph">
<p>Now create the <a href="../api/io/micronaut/coherence/FilterFactory.html">FilterFactory</a> implementation that will produce instances of the required <code>Filter</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import com.tangosol.util.Filter;
import com.tangosol.util.Filters;
import io.micronaut.coherence.FilterFactory;

@AdultMales    <i class="conum" data-value="1"></i><b>(1)</b>
@Singleton     <i class="conum" data-value="2"></i><b>(2)</b>
public class AdultMalesFilterFactory&lt;Person&gt; implements FilterFactory&lt;AdultMales, Person&gt; {
    @Override
    public Filter&lt;Person&gt; create(AdultMales annotation) {       <i class="conum" data-value="3"></i><b>(3)</b>
        Filter&lt;Person&gt; male = Filters.equal("gender", "male");
        Filter&lt;Person&gt; adult = Filters.greaterEqual(Extractors.extract("age"), 18);
        return Filters.all(male, adult);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The class is annotated with the <code>AdultMales</code> filter binding annotation</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The class must be a Micronaut bean, in this case a singleton</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>create</code> method uses the Coherence <code>filters</code> API to create the required <code>filter</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The parameter to the <code>create</code> method is the annotation used on the injection point.
In this case the annotation has no values, but if it did we could access those values to customize how the filter is created.</p>
</div>
<div class="paragraph">
<p>For example, we could have just called the annotation <code>@Adults</code> and made the gender a parameter like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@FilterBinding
@Documented
@Retention(RetentionPolicy.RUNTIME)
public @interface Adults {
    String value();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And changed the filter factory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Adult
@Singleton
public class AdultFilterFactory&lt;Person&gt; implements FilterFactory&lt;Adults, Person&gt; {
    @Override
    public Filter&lt;Person&gt; create(Males annotation) {       <i class="conum" data-value="3"></i><b>(3)</b>
        Filter&lt;Person&gt; male = Filters.equal("gender", annotation.value());
        Filter&lt;Person&gt; adult = Filters.greaterEqual(Extractors.extract("age"), 18);
        return Filters.all(male, adult);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_annotate_the_injection_point">Annotate the Injection Point</h3>
<div class="paragraph">
<p>Now the application code where the view is to be injected can use the custom filter binding annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@View               <i class="conum" data-value="1"></i><b>(1)</b>
@AdultMales         <i class="conum" data-value="2"></i><b>(2)</b>
@Name("people")     <i class="conum" data-value="3"></i><b>(3)</b>
private NamedMap&lt;String, Person&gt; adultMales;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@View</code> annotation indicates that this is a view rather than a plain <code>NamedMap</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>@AdultMales</code> annotation links to the custom filter factory to use to create the filter for the view</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>@Name</code> annotation indicates the underlying cache/map name to use for the view</td>
</tr>
</table>
</div>
</div>

<h1 id="valueExtractorBinding"><a class="anchor" href="#valueExtractorBinding"></a>10 Extractor Binding Annotations</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/valueExtractorBinding.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>ValueExtractor binding annotations are normal annotations that are themselves annotated with the <a href="../api/io/micronaut/coherence/annotation/ExtractorBinding.html">@ExtractorBinding</a> meta-annotation.
An extractor binding annotation represents a Coherence <a href="https://coherence.community/latest/21.12/api/java/index.html/com/tangosol/util/ValueExtractor.html">ValueExtractor</a> and is used to specify a <code>ValueExtractor</code> in certain injection points, for example a View (CQC), <code>NamedTopic</code> <code>Subscriber</code> beans, <code>MapEvent</code> listeners, etc.</p>
</div>
<div class="paragraph">
<p>There are three parts to using an extractor binding:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The extractor binding annotation</p>
</li>
<li>
<p>An implementation of a <a href="../api/io/micronaut/coherence/ExtractorFactory.html">ExtractorFactory</a> that is annotated with the extractor binding annotation. This is a factory that produces the required <code>ValueExtractor</code>.</p>
</li>
<li>
<p>Injection points annotated with the extractor binding annotation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example; assume there is a Coherence <code>NamedMap</code> with the name <code>people</code> that contains <code>Person</code> instances for the value.
Among the various properties on the <code>Person</code> class is a property called <code>age</code>.
Now assume we want to inject a view that uses the <code>age</code> property for the value, we would need a <code>ValueExtractor</code> that extracts the <code>age</code> property.</p>
</div>
<div class="sect2">
<h3 id="_create_the_extractor_binding_annotation">Create the extractor binding annotation</h3>
<div class="paragraph">
<p>First create a simple annotation, it could be called something like <code>PersonAge</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ExtractorBinding                         <i class="conum" data-value="1"></i><b>(1)</b>
@Documented
@Retention(RetentionPolicy.RUNTIME)
public @interface PersonAge {            <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The annotation class is annotated with <code>@ExtractorBinding</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The annotation name is <code>PersonAge</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In this case the annotation does not need any other attributes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_create_the_extractorfactory">Create the <code>ExtractorFactory</code></h3>
<div class="paragraph">
<p>Now create the <a href="../api/io/micronaut/coherence/ExtractorFactory.html">ExtractorFactory</a> implementation that will produce instances of the required <code>ValueExtractor</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import com.tangosol.util.Extractors;
import com.tangosol.util.ValueExtractor;
import io.micronaut.coherence.ValueExtractorFactory;

@PersonAge     <i class="conum" data-value="1"></i><b>(1)</b>
@Singleton     <i class="conum" data-value="2"></i><b>(2)</b>
public class PersonAgeExtractorFactory&lt;Person&gt; implements ExtractorFactory&lt;AdultMales, Person&gt; {
    @Override
    public ValueExtractor&lt;Person, Integer&gt; create(PersonAge annotation) {       <i class="conum" data-value="3"></i><b>(3)</b>
        return Extractors.extract("age");
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The class is annotated with the <code>PersonAge</code> filter binding annotation</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The class must be a Micronaut bean, in this case a singleton</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The create method uses the Coherence <code>Extractors</code> API to create the required extractor, in this case a trivial property extractor.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The parameter to the <code>create</code> method is the annotation used on the injection point.
In this case the annotation has no values, but if it did we could access those values to customize how the <code>ValueExtractor</code> is created.</p>
</div>
</div>
<div class="sect2">
<h3 id="_annotate_the_injection_point">Annotate the Injection Point</h3>
<div class="paragraph">
<p>Now the application code where the view is to be injected can use the custom extractor binding annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@View               <i class="conum" data-value="1"></i><b>(1)</b>
@PersonAge          <i class="conum" data-value="2"></i><b>(2)</b>
@Name("people")     <i class="conum" data-value="3"></i><b>(3)</b>
private NamedMap&lt;String, Integer&gt; ages;   <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>@View</code> annotation indicates that this is a view rather than a plain <code>NamedMap</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>@PersonAge</code> annotation links to the custom extractor factory used to create the <code>ValueExtractor</code> for the view</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>@Name</code> annotation indicates the underlying cache/map name to use for the view</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Note that the <code>NamedMap</code> generics are now <code>String</code> and <code>Integer</code> not <code>String</code> and <code>Person</code> as the <code>Person</code> values from the underlying cache are transformed into <code>Integer</code> values by extracting just the age property.</td>
</tr>
</table>
</div>
</div>

<h1 id="transientInjection"><a class="anchor" href="#transientInjection"></a>11 Injection into Deserialized Objects</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/transientInjection.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Using Micronaut to inject Coherence objects into your application classes, and Micronaut beans into Coherence-managed objects will
allow you to support many use cases where dependency injection may be useful, but it doesn&#8217;t cover an important use
case that is somewhat specific to Coherence.</p>
</div>
<div class="paragraph">
<p>Coherence is a distributed system, and it uses serialization in order to send both the data and the  processing requests
from one cluster member (or remote client) to another, as well as to store data, both in memory and on disk.</p>
</div>
<div class="paragraph">
<p>Processing requests, such as entry processors and aggregators, have to be deserialized on a target cluster member(s) in
order to be executed. In some cases, they could benefit from dependency injection in order to avoid service lookups.</p>
</div>
<div class="paragraph">
<p>Similarly, while the data is stored in a serialized, binary format, it may need to be deserialized into user supplied
classes for server-side processing, such as when executing entry processors and aggregators. In this case, data classes
can often also benefit from dependency injection (in order to support Domain-Driven Design (DDD), for example).</p>
</div>
<div class="paragraph">
<p>While these transient objects are not managed by the Micronaut container, Coherence Micronaut does support their injection during
deserialization, but for performance reasons requires that you explicitly opt in by implementing
<code>com.oracle.coherence.inject.Injectable</code> interface.</p>
</div>
<div class="sect2">
<h3 id="_making_transient_classes_injectable">Making transient classes Injectable</h3>
<div class="paragraph">
<p>While not technically a true marker interface, <code>com.oracle.coherence.inject.Injectable</code> can be treated as such for
all intents and purposes.
All you need to do is add it to the <code>implements</code> clause of your class in order for injection on deserialization to
kick in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class InjectableBean
        implements Injectable, Serializable {

    @Inject
    private Converter&lt;String, String&gt; converter;

    private String text;

    InjectableBean() {
    }

    InjectableBean(String text) {
        this.text = text;
    }

    String getConvertedText() {
        return converter.convert(text);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming that you have the following <code>Converter</code> service implementation in your application, it will be injected
into <code>InjectableBean</code> during deserialization, and the <code>getConvertedText</code> method will return the value of the <code>text</code>
field converted to upper case:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class ToUpperConverter
        implements Converter&lt;String, String&gt; {
    @Override
    public String convert(String s) {
        return s.toUpperCase();
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If your <code>Injectable</code> class has <code>@PostConstruct</code> callback method, it will be called after the injection.
However, because we have no control over object&#8217;s lifecycle after that point, <code>@PreDestroy</code> callback will <strong>never</strong> be called).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You should note that the above functionality is not dependent on the serialization format and will work with both
Java and POF serialization (or any other custom serializer), and for any object that is  deserialized on any Coherence
member (or even on a remote client).</p>
</div>
<div class="paragraph">
<p>While the deserialized transient objects are not true Micronaut managed beans, being able to inject Micronaut managed dependencies
into them upon deserialization will likely satisfy most dependency injection requirements you will ever have in those
application components.</p>
</div>
</div>

<h1 id="coherenceXmlInjection"><a class="anchor" href="#coherenceXmlInjection"></a>12 Injecting Beans into Coherence Configuration</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/coherenceXmlInjection.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>You can inject Micronaut beans into the standard Coherence cache configuration file by using the Coherence Micronaut
custom namespace handler.</p>
</div>
<div class="paragraph">
<p>Custom namespace handlers are a standard feature of Coherence that allow the cache configuration file to be customized considerably.</p>
</div>
<div class="paragraph">
<p>The Coherence Micronaut custom namespace handler provides a single additional XML element named <code>&lt;bean&gt;</code> that is
used to declare a named Micronaut bean for injection into the configuration.</p>
</div>
<div class="paragraph">
<p>To use the Coherence Micronaut custom namespace handler it must be declared in the XML configuration file alongside the
other XSD values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0"?&gt;
&lt;cache-config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="http://xmlns.oracle.com/coherence/coherence-cache-config"
        xmlns:m="class://io.micronaut.coherence.namespace.MicronautNamespaceHandler"   <i class="conum" data-value="1"></i><b>(1)</b>
        xsi:schemaLocation="http://xmlns.oracle.com/coherence/coherence-cache-config coherence-cache-config.xsd"&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The namespace is declared as <code>xmlns:m="class://io.micronaut.coherence.namespace.MicronautNamespaceHandler"</code>
where <code>io.micronaut.coherence.namespace.MicronautNamespaceHandler</code> is actually the class implementing the custom
namespace handler. The <code>m</code> prefix in <code>xmlns:m</code> means that the custom XML elements should be prefixed with <code>m:</code>
so in this case <code>&lt;m:bean&gt;beanName&lt;/m:bean&gt;</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>&lt;bean&gt;</code> element can be used anywhere in the configuration that an <code>instance</code> element would be used, for example
when declaring interceptors, cache stores, listeners, etc.</p>
</div>
<div class="paragraph">
<p>For examples, with the following entry event interceptor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import jakarta.inject.Singleton;

import com.tangosol.net.events.EventInterceptor;
import com.tangosol.net.events.annotation.EntryEvents;
import com.tangosol.net.events.annotation.Interceptor;
import com.tangosol.net.events.partition.cache.EntryEvent;

@Singleton
@Named("Foo")   <i class="conum" data-value="1"></i><b>(1)</b>
@Interceptor
@EntryEvents({EntryEvent.Type.INSERTED, EntryEvent.Type.UPDATED, EntryEvent.Type.REMOVED})
public class MyInterceptor implements EventInterceptor&lt;EntryEvent&lt;?, ?&gt;&gt; {
    @Override
    public void onEvent(EntryEvent&lt;?, ?&gt; event) {
        // process the event.
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The interceptor is a <code>@Singleton</code> bean <code>@Named</code> with the name <code>Foo</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This bean can be referenced in the cache configuration file, for example as an interceptor in a cache mapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0"?&gt;
&lt;cache-config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="http://xmlns.oracle.com/coherence/coherence-cache-config"
        xmlns:m="class://io.micronaut.coherence.namespace.MicronautNamespaceHandler"
        xsi:schemaLocation="http://xmlns.oracle.com/coherence/coherence-cache-config coherence-cache-config.xsd"&gt;

    &lt;caching-scheme-mapping&gt;
        &lt;cache-mapping&gt;
            &lt;cache-name&gt;*&lt;/cache-name&gt;
            &lt;scheme-name&gt;distributed-scheme&lt;/scheme-name&gt;
            &lt;interceptors&gt;
                &lt;interceptor&gt;
                    &lt;instance&gt;
                        &lt;m:bean&gt;Foo&lt;/m:bean&gt;   <i class="conum" data-value="1"></i><b>(1)</b>
                    &lt;/instance&gt;
                &lt;/interceptor&gt;
            &lt;/interceptors&gt;
        &lt;/cache-mapping&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>Foo</code> interceptor will be injected into the cache mapping.</td>
</tr>
</table>
</div>

<h1 id="coherenceHttpSessions"><a class="anchor" href="#coherenceHttpSessions"></a>13 Using Coherence to store HTTP sessions</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/coherenceHttpSessions.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To use <a href="https://coherence.community/">Coherence</a> as a Micronaut HTTP session store add the <code>micronaut-coherence-session</code> dependency:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut.coherence:micronaut-coherence-session")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.coherence&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-coherence-session&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>Also, add a Coherence dependency - either Coherence CE or commercial version:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"com.oracle.coherence.ce:coherence:23.03")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;com.oracle.coherence.ce&lt;/groupId&gt;
    &lt;artifactId&gt;coherence&lt;/artifactId&gt;
    &lt;version&gt;23.03&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>Enable Coherence sessions via configuration in the application configuration file:</p>
</div>
<div class="openblock">
<div class="title">Enabling Coherence Sessions</div>
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">micronaut.session.http.coherence.enabled=true
micronaut.session.http.coherence.cache-name=http-session-cache</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">micronaut:
  session:
    http:
      coherence:
        enabled: true
        cache-name: http-session-cache</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[micronaut]
  [micronaut.session]
    [micronaut.session.http]
      [micronaut.session.http.coherence]
        enabled=true
        cache-name="http-session-cache"</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">micronaut {
  session {
    http {
      coherence {
        enabled = true
        cacheName = "http-session-cache"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  micronaut {
    session {
      http {
        coherence {
          enabled = true
          cache-name = "http-session-cache"
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "micronaut": {
    "session": {
      "http": {
        "coherence": {
          "enabled": true,
          "cache-name": "http-session-cache"
        }
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cache-name</code> (optional) names the cache that will be used for sessions. By default <code>http-sessions</code> cache will be used.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Coherence cache will be obtained using default Coherence session.</p>
</div>
<div class="paragraph">
<p>In case that cache is configured to use POF serialization, additional POF configuration for the class <code>io.micronaut.coherence.httpsession.CoherenceSessionStore$CoherenceHttpSession</code> has to be added to the POF config. User can pick appropriate value for <code>type-id</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;user-type&gt;
      &lt;type-id&gt;2001&lt;/type-id&gt;
      &lt;class-name&gt;io.micronaut.coherence.httpsession.CoherenceSessionStore$CoherenceHttpSession&lt;/class-name&gt;
    &lt;/user-type&gt;</code></pre>
</div>
</div>

<h1 id="cache"><a class="anchor" href="#cache"></a>14 Using Coherence as Micronaut Cache implementation</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/cache.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To use <a href="https://coherence.community/">Coherence</a> as the <a href="https://docs.micronaut.io/latest/guide/index.html#caching">caching</a> implementation, add it as a dependency to your application:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut.coherence:micronaut-coherence-cache")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.coherence&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-coherence-cache&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>Also, add Coherence dependency - either Coherence CE or commercial version:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"com.oracle.coherence.ce:coherence:23.03")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;com.oracle.coherence.ce&lt;/groupId&gt;
    &lt;artifactId&gt;coherence&lt;/artifactId&gt;
    &lt;version&gt;23.03&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>When using the <a href="https://micronaut-projects.github.io/micronaut-cache/latest/api/io/micronaut/cache/annotation/Cacheable.html">@Cacheable</a> and other Cache Annotations, Micronaut will use default Coherence session to obtain cache instance for caching. It&#8217;s up to the user to configure Coherence specific cache.</p>
</div>
<div class="paragraph">
<p>You can also add Coherence module to your project using <code>mn</code> CLI feature:</p>
</div>
<div class="listingblock">
<div class="title">Create a Micronaut application with Coherence cache module</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ mn create-app hello-world -f cache-coherence</code></pre>
</div>
</div>
<div class="paragraph">
<p>To disable Coherence:</p>
</div>
<div class="openblock">
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">coherence.cache.enabled=false</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">coherence:
  cache:
    enabled: false</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[coherence]
  [coherence.cache]
    enabled=false</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">coherence {
  cache {
    enabled = false
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  coherence {
    cache {
      enabled = false
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "coherence": {
    "cache": {
      "enabled": false
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>

<h1 id="distributedConfiguration"><a class="anchor" href="#distributedConfiguration"></a>15 Using Coherence as a Distributed Configuration provider</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/micronaut-projects/micronaut-coherence/edit/master/src/main/docs/guide/distributedConfiguration.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>To use <a href="https://coherence.community/">Coherence</a> to store configuration values, add following dependencies:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"io.micronaut.coherence:micronaut-coherence-distributed-configuration")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;io.micronaut.coherence&lt;/groupId&gt;
    &lt;artifactId&gt;micronaut-coherence-distributed-configuration&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>Also, add Coherence dependency - either Coherence CE or commercial version:</p>
</div>
<div class="paragraph">
<p>        <div class="listingblock multi-language-sample">
<div class="title"></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="gradle">implementation(<span class="hljs-string">"com.oracle.coherence.ce:coherence:23.03")</span></code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="maven">&lt;dependency&gt;
    &lt;groupId&gt;com.oracle.coherence.ce&lt;/groupId&gt;
    &lt;artifactId&gt;coherence&lt;/artifactId&gt;
    &lt;version&gt;23.03&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div></p>
</div>
<div class="paragraph">
<p>To enable support simply add the following configuration to your bootstrap configuration file:</p>
</div>
<div class="openblock">
<div class="title">Integrating with Oracle Coherence</div>
<div class="content">
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">micronaut.application.name=hello-world
micronaut.config-client.enabled=true
coherence.sessions.config.type=client
coherence.configuration.client.enabled=true
coherence.configuration.client.session=client</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">micronaut:
  application:
    name: hello-world
  config-client:
    enabled: true

coherence:
  sessions:
    config:
      type: client
  configuration:
    client:
      enabled: true
      session: client</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[micronaut]
  [micronaut.application]
    name="hello-world"
  [micronaut.config-client]
    enabled=true
[coherence]
  [coherence.sessions]
    [coherence.sessions.config]
      type="client"
  [coherence.configuration]
    [coherence.configuration.client]
      enabled=true
      session="client"</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy-config hljs" data-lang="groovy-config">micronaut {
  application {
    name = "hello-world"
  }
  configClient {
    enabled = true
  }
}
coherence {
  sessions {
    config {
      type = "client"
    }
  }
  configuration {
    client {
      enabled = true
      session = "client"
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-hocon hljs" data-lang="hocon">{
  micronaut {
    application {
      name = "hello-world"
    }
    config-client {
      enabled = true
    }
  }
  coherence {
    sessions {
      config {
        type = "client"
      }
    }
    configuration {
      client {
        enabled = true
        session = "client"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="listingblock multi-language-sample">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json-config hljs" data-lang="json-config">{
  "micronaut": {
    "application": {
      "name": "hello-world"
    },
    "config-client": {
      "enabled": true
    }
  },
  "coherence": {
    "sessions": {
      "config": {
        "type": "client"
      }
    },
    "configuration": {
      "client": {
        "enabled": true,
        "session": "client"
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This will create a configuration client using the session named <code>client</code> to connect to
a Coherence proxy server over extend and allow the application to lookup property sources for the application
from Coherence.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Configuration Resolution Precedence</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Cache</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration shared by all applications</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[APPLICATION_NAME]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application specific configuration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application-[ENV_NAME]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration shared by all applications for an active environment name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[APPLICATION_NAME]-[ENV_NAME]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application specific configuration for an active environment name</p></td>
</tr>
</tbody>
</table>

    </div>
</div>

<script type="text/javascript">

</script>
</body>
</html>
